{"version":3,"sources":["App.js","index.js","../../node_modules/tslib/tslib.es6.js","../../node_modules/xstate/es/_virtual/_tslib.js","../../node_modules/xstate/es/constants.js","../../node_modules/xstate/es/utils.js","../../node_modules/xstate/es/types.js","../../node_modules/xstate/es/actionTypes.js","../../node_modules/xstate/es/actions.js","../../node_modules/xstate/es/stateUtils.js","../../node_modules/xstate/es/State.js","../../node_modules/xstate/es/Actor.js","../../node_modules/xstate/es/StateNode.js","../../node_modules/xstate/es/Machine.js","../../node_modules/xstate/es/scheduler.js","../../node_modules/xstate/es/registry.js","../../node_modules/xstate/es/interpreter.js","../../node_modules/xstate/es/index.js","../../node_modules/xstate/es/mapState.js","../../node_modules/xstate/es/match.js","../../node_modules/@xstate/react/lib/useActor.js","../../node_modules/@xstate/react/lib/index.js","../../src/index.tsx"],"names":["App","usePromiseManager","state","manage","React","useState","stuff","setStuff","Promise","resolve","reject","setTimeout","data","then","result","isResolving","ReactDOM","render","document","getElementById","__generator","thisArg","body","f","y","t","g","_","label","sent","trys","ops","next","verb","Symbol","iterator","this","n","v","op","TypeError","call","done","value","pop","length","push","e","step","Object","assign","s","i","arguments","p","prototype","hasOwnProperty","apply","__rest","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__values","o","m","__read","r","ar","error","__spread","concat","EMPTY_ACTIVITY_MAP","keys","matchesState","parentStateId","childStateId","delimiter","parentStateValue","toStateValue","childStateValue","isString","every","key","getEventType","event","type","Error","toStatePath","stateId","isArray","toString","split","stateValue","pathToStateValue","statePath","marker","mapValues","collection","iteratee","collectionKeys","mapFilterValues","predicate","e_1","_a","_b","_c","item","e_1_1","return","path","props","object","e_2","props_1","props_1_1","e_2_1","toStatePaths","flatten","map","subStateValue","subPath","array","toArrayStrict","toArray","undefined","mapContext","mapper","context","_event","e_5","isFunction","subMapper","e_5_1","isPromiseLike","partition","items","e_6","truthy","falsy","items_1","items_1_1","e_6_1","updateHistoryStates","hist","states","subHist","current","Array","toGuard","condition","guardMap","name","isObservable","subscribe","symbolObservable","observable","isMachine","ActionTypes","SpecialTargets","uniqueId","currentId","toEventObject","payload","toSCXMLEvent","scxmlEvent","$$type","eventObject","toTransitionConfigArray","configLike","transitionLike","target","start","Start","stop","Stop","raise","Raise","send","Send","cancel","Cancel","nullEvent","NullEvent","Assign","log","After","DoneState","Log","init","Init","invoke","Invoke","errorPlatform","ErrorExecution","ErrorPlatform","ErrorCustom","update","Update","pure","Pure","initEvent","getActionFunction","actionType","actionFunctionMap","toActionObject","action","actionObject","exec","other","defineProperty","enumerable","configurable","toActionObjects","subAction","toActivityDefinition","id","raise$1","to","Internal","options","send$1","delay","sendParent","Parent","sendUpdate","defaultLogExpr","sendId","cancel$1","activity","activityDef","assignment","assign$1","after","delayRef","idSuffix","doneInvoke","DoneInvoke","forwardTo","isLeafNode","stateNode","getChildren","getAllStateNodes","stateNodes","getConfiguration","prevStateNodes","e_3","e_4","_d","prevAdjList","getAdjList","Set","configuration","configuration_1","configuration_1_1","parent","has","add","adjList","configuration_2","configuration_2_1","get","_e","_f","child","forEach","sn","initialStateNodes","e_3_1","configuration_3","configuration_3_1","e_4_1","Map","configuration_4","configuration_4_1","set","getValue","rootNode","getValueFromAdj","baseNode","childStateNodes","childStateNode","csn","iterable","some","member","isInFinalState","State","config","actions","activities","meta","events","_sessionid","historyValue","history","matches","bind","toStrings","transitions","children","ownEvents","from","create","inert","_this","valueKeys","toJSON","isActor","EMPTY_OBJECT","isStateId","str","StateNode","order","__xstatenode","__cache","relativeValue","initialStateValue","initialState","on","candidates","delayedTransitions","idMap","guards","services","delays","_parent","_key","machine","join","version","parallel","initial","stateConfig","dfs","_transient","strict","onEntry","entry","onExit","exit","invokeConfig","src","invokeSrc","transition","_init","withConfig","withContext","definition","reduce","eventType","getDelayedTransitions","formatTransitions","getCandidates","eventName","transient","filter","sameEventType","afterConfig","mutateEntryExit","configTransition","resolvedTransition","resolvedDelay","isNaN","delayedTransition","formatTransition","getStateNodes","getStateNode","subStateKeys","subStateKey","allSubStateNodes","subStateNode","handles","includes","resolveState","transitionLeafNode","transitionCompoundNode","_transition","transitionParallelNode","transitionMap","stateTransitions","enabledTransitions","st","entryNodes","entrySet","exitSet","source","selectedTransition","nextStateNodes","candidate","cond","stateIn","in","resolvedContext","isInState","getStateNodeById","slice","guardPassed","evaluateGuard","err","message","allNextStateNodes","getRelativeStateNodes","isInternal","internal","nodesFromChild","escapes","nodes","guard","guardMeta","condFn","getActions","currentContext","prevState","prevConfig","resolvedConfig","resolvedConfig_1","resolvedConfig_1_1","prevConfig_1","prevConfig_1_1","doneEvents","grandparent","parentNode","sort","a","b","entryStates","exitStates","entryActions","exitActions","currentState","resolvedStateValue","getResolvedPath","test","stateTransition","resolveTransition","resolveRaisedTransition","originalEvent","currentActions","unshift","actions_1","actions_1_1","start$1","stop$1","assignActions","otherActions","updatedContext","acc","assignAction","e_7","partialUpdate","propAssignment","e_7_1","updateContext","resolvedActions","resolveRaise","sendAction","ctx","delaysMap","resolvedEvent","configDelay","resolvedTarget","resolveSend","expr","resolveLog","raisedEvents","nonRaisedActions","invokeDefinition","tempActor","unsubscribe","createInvocableActor","resolvedConfiguration","isDone","nextState","changed","maybeNextState","raisedEvent","shift","stateValuesEqual","aKeys","bKeys","stateKey","resolvedStateId","getStateNodeByPath","arrayStatePath","currentStateNode","stateIdentifier","getInitialState","historyConfig","relativeStateId","resolveHistory","initialPath","getFromRelativePath","relativePath","childStatePath","relativeStateValue","historyTarget","relativeChildPath","accessorProp","subHistoryValue","props_2","props_2_1","prop","subStatePath","childStateIds","stateIds","e_8","event_1","e_8_1","resolveTarget","_target","isInternalTarget","transitionConfig","normalizedTarget","normalizeTarget","e_9","onConfig","wildcardConfigs","strictOnConfigs_1","arrayified","doneConfig","onDone","String","invokeDef","settleTransitions","onError","formattedTransitions","delayedTransitions_1","delayedTransitions_1_1","e_9_1","Machine","initialContext","resolvedInitialContext","defaultOptions","deferEvents","Scheduler","processingEvent","queue","initialized","initialize","callback","schedule","process","flushEvents","task","clear","nextCallback","sessionIdIndex","registry","actor","InterpreterStatus","DEFAULT_SPAWN_OPTIONS","sync","autoForward","withServiceScope","serviceStack","service","fn","Interpreter","sessionId","scheduler","delayedEventsMap","listeners","contextListeners","stopListeners","doneListeners","eventListeners","sendListeners","_status","NotStarted","batch","Stopped","Running","JSON","stringify","forward","_state","sendTo","isParent","error$1","origin","resolvedOptions","clock","logger","resolvedId","_initialState","execute","actionsConfig","devTools","listener","_g","_h","_j","_k","contextListener","finalChildStateNode","find","doneData","_l","_m","onTransition","nextListenerOrObserver","errorListener","completeListener","resolvedCompleteListener","complete","delete","onEvent","onSend","onChange","onStop","off","resolvedState","attachDev","e_10","_o","_p","_q","clearTimeout","e_10_1","e_11","batchChanged","batchedActions","_loop_1","bindActionToState","events_1","events_1_1","e_11_1","sender","nextEvents","nextEvent","e_12","e_12_1","defer","actionOrExec","serviceCreator","spawnPromise","spawnCallback","spawnObservable","spawnMachine","spawnActivity","stopChild","childId","spawn","entity","spawnActor","childService","doneEvent","promise","canceled","response","errorData","errorEvent","handleError","unsubscribed","callbackStop","receivers","newListener","receiver","subscription","implementation","dispose","spawnEffect","window","__REDUX_DEVTOOLS_EXTENSION__","devToolsOptions","connect","autoPause","stateSanitizer","features","jump","skip","global","ms","console","interpret","log$1","respond","__","escalate","stateMap","foundStateId","mappedStateId","nameOrOptions","resolveSpawnOptions","patterns","defaultValue","patterns_1","patterns_1_1","exports","react_1","setCurrent","actorRef","useRef","useEffect","sub_1","__assign","immediate","rehydratedState","interpreterOptions","machineConfig","machineRef","serviceRef","xstate_1","sub","useActor_1","useActor","ManagePromiseMachine","count","idle","INIT","_context","pending","RESOLVE","REJECT","React.useMemo","hasError","React.useCallback","_arguments","generator","catch","P","fulfilled","rejected"],"mappings":"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","file":"static/js/main.4629473e.chunk.js","sourcesContent":["import React from \"react\";\n\nimport { usePromiseManager } from \"use-promise-manager\";\n\nconst fetchStuff = () => {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      resolve({ data: \"stuff\" });\n    }, 2000);\n  });\n};\n\nconst App = () => {\n  const [state, manage] = usePromiseManager();\n  const [stuff, setStuff] = React.useState(\"\");\n  React.useState(() => {\n    manage(fetchStuff()).then(result => setStuff(result.data));\n  }, []);\n\n  return <div>{state.isResolving ? \"isLoading\" : stuff}</div>;\n};\nexport default App;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nfunction __values(o) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator],\n      i = 0;\n  if (m) return m.call(o);\n  return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n\n  return ar;\n}\n\nexport { __assign, __read, __rest, __spread, __values };","var STATE_DELIMITER = '.';\nvar EMPTY_ACTIVITY_MAP = {};\nvar DEFAULT_GUARD_TYPE = 'xstate.guard';\nvar TARGETLESS_KEY = '';\nexport { DEFAULT_GUARD_TYPE, EMPTY_ACTIVITY_MAP, STATE_DELIMITER, TARGETLESS_KEY };","import { __spread, __values, __read, __assign } from './_virtual/_tslib.js';\nimport { DEFAULT_GUARD_TYPE, TARGETLESS_KEY, STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\n\nfunction keys(value) {\n  return Object.keys(value);\n}\n\nfunction matchesState(parentStateId, childStateId, delimiter) {\n  if (delimiter === void 0) {\n    delimiter = STATE_DELIMITER;\n  }\n\n  var parentStateValue = toStateValue(parentStateId, delimiter);\n  var childStateValue = toStateValue(childStateId, delimiter);\n\n  if (isString(childStateValue)) {\n    if (isString(parentStateValue)) {\n      return childStateValue === parentStateValue;\n    } // Parent more specific than child\n\n\n    return false;\n  }\n\n  if (isString(parentStateValue)) {\n    return parentStateValue in childStateValue;\n  }\n\n  return keys(parentStateValue).every(function (key) {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\n\nfunction getEventType(event) {\n  try {\n    return isString(event) || typeof event === 'number' ? \"\" + event : event.type;\n  } catch (e) {\n    throw new Error('Events must be strings or objects with a string event.type property.');\n  }\n}\n\nfunction toStatePath(stateId, delimiter) {\n  try {\n    if (isArray(stateId)) {\n      return stateId;\n    }\n\n    return stateId.toString().split(delimiter);\n  } catch (e) {\n    throw new Error(\"'\" + stateId + \"' is not a valid state path.\");\n  }\n}\n\nfunction isStateLike(state) {\n  return typeof state === 'object' && 'value' in state && 'context' in state && 'event' in state && '_event' in state;\n}\n\nfunction toStateValue(stateValue, delimiter) {\n  if (isStateLike(stateValue)) {\n    return stateValue.value;\n  }\n\n  if (isArray(stateValue)) {\n    return pathToStateValue(stateValue);\n  }\n\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n\n  var statePath = toStatePath(stateValue, delimiter);\n  return pathToStateValue(statePath);\n}\n\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n\n  var value = {};\n  var marker = value;\n\n  for (var i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      marker[statePath[i]] = {};\n      marker = marker[statePath[i]];\n    }\n  }\n\n  return value;\n}\n\nfunction mapValues(collection, iteratee) {\n  var result = {};\n  var collectionKeys = keys(collection);\n\n  for (var i = 0; i < collectionKeys.length; i++) {\n    var key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n\n  return result;\n}\n\nfunction mapFilterValues(collection, iteratee, predicate) {\n  var e_1, _a;\n\n  var result = {};\n\n  try {\n    for (var _b = __values(keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var item = collection[key];\n\n      if (!predicate(item)) {\n        continue;\n      }\n\n      result[key] = iteratee(item, key, collection);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return result;\n}\n/**\r\n * Retrieves a value at the given path.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nvar path = function (props) {\n  return function (object) {\n    var e_2, _a;\n\n    var result = object;\n\n    try {\n      for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        result = result[prop];\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return result;\n  };\n};\n/**\r\n * Retrieves a value at the given path via the nested accessor prop.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nfunction nestedPath(props, accessorProp) {\n  return function (object) {\n    var e_3, _a;\n\n    var result = object;\n\n    try {\n      for (var props_2 = __values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n        var prop = props_2_1.value;\n        result = result[accessorProp][prop];\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return result;\n  };\n}\n\nfunction toStatePaths(stateValue) {\n  if (!stateValue) {\n    return [[]];\n  }\n\n  if (isString(stateValue)) {\n    return [[stateValue]];\n  }\n\n  var result = flatten(keys(stateValue).map(function (key) {\n    var subStateValue = stateValue[key];\n\n    if (typeof subStateValue !== 'string' && (!subStateValue || !Object.keys(subStateValue).length)) {\n      return [[key]];\n    }\n\n    return toStatePaths(stateValue[key]).map(function (subPath) {\n      return [key].concat(subPath);\n    });\n  }));\n  return result;\n}\n\nfunction flatten(array) {\n  var _a;\n\n  return (_a = []).concat.apply(_a, __spread(array));\n}\n\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n\n  return [value];\n}\n\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n\n  return toArrayStrict(value);\n}\n\nfunction mapContext(mapper, context, _event) {\n  var e_5, _a;\n\n  if (isFunction(mapper)) {\n    return mapper(context, _event.data);\n  }\n\n  var result = {};\n\n  try {\n    for (var _b = __values(keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var subMapper = mapper[key];\n\n      if (isFunction(subMapper)) {\n        result[key] = subMapper(context, _event.data);\n      } else {\n        result[key] = subMapper;\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return result;\n}\n\nfunction isBuiltInEvent(eventType) {\n  return /^(done|error)\\./.test(eventType);\n}\n\nfunction isPromiseLike(value) {\n  if (value instanceof Promise) {\n    return true;\n  } // Check if shape matches the Promise/A+ specification for a \"thenable\".\n\n\n  if (value !== null && (isFunction(value) || typeof value === 'object') && isFunction(value.then)) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction partition(items, predicate) {\n  var e_6, _a;\n\n  var _b = __read([[], []], 2),\n      truthy = _b[0],\n      falsy = _b[1];\n\n  try {\n    for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n      var item = items_1_1.value;\n\n      if (predicate(item)) {\n        truthy.push(item);\n      } else {\n        falsy.push(item);\n      }\n    }\n  } catch (e_6_1) {\n    e_6 = {\n      error: e_6_1\n    };\n  } finally {\n    try {\n      if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n    } finally {\n      if (e_6) throw e_6.error;\n    }\n  }\n\n  return [truthy, falsy];\n}\n\nfunction updateHistoryStates(hist, stateValue) {\n  return mapValues(hist.states, function (subHist, key) {\n    if (!subHist) {\n      return undefined;\n    }\n\n    var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) || (subHist ? subHist.current : undefined);\n\n    if (!subStateValue) {\n      return undefined;\n    }\n\n    return {\n      current: subStateValue,\n      states: updateHistoryStates(subHist, subStateValue)\n    };\n  });\n}\n\nfunction updateHistoryValue(hist, stateValue) {\n  return {\n    current: stateValue,\n    states: updateHistoryStates(hist, stateValue)\n  };\n}\n\nfunction updateContext(context, _event, assignActions, state) {\n  if (!IS_PRODUCTION) {\n    warn(!!context, 'Attempting to update undefined context');\n  }\n\n  var updatedContext = context ? assignActions.reduce(function (acc, assignAction) {\n    var e_7, _a;\n\n    var assignment = assignAction.assignment;\n    var meta = {\n      state: state,\n      action: assignAction,\n      _event: _event\n    };\n    var partialUpdate = {};\n\n    if (isFunction(assignment)) {\n      partialUpdate = assignment(acc, _event.data, meta);\n    } else {\n      try {\n        for (var _b = __values(keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n          var propAssignment = assignment[key];\n          partialUpdate[key] = isFunction(propAssignment) ? propAssignment(acc, _event.data, meta) : propAssignment;\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n    }\n\n    return Object.assign({}, acc, partialUpdate);\n  }, context) : context;\n  return updatedContext;\n} // tslint:disable-next-line:no-empty\n\n\nvar warn = function () {};\n\nif (!IS_PRODUCTION) {\n  warn = function (condition, message) {\n    var error = condition instanceof Error ? condition : undefined;\n\n    if (!error && condition) {\n      return;\n    }\n\n    if (console !== undefined) {\n      var args = [\"Warning: \" + message];\n\n      if (error) {\n        args.push(error);\n      } // tslint:disable-next-line:no-console\n\n\n      console.warn.apply(console, args);\n    }\n  };\n}\n\nfunction isArray(value) {\n  return Array.isArray(value);\n} // tslint:disable-next-line:ban-types\n\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\nfunction isString(value) {\n  return typeof value === 'string';\n} // export function memoizedGetter<T, TP extends { prototype: object }>(\n//   o: TP,\n//   property: string,\n//   getter: () => T\n// ): void {\n//   Object.defineProperty(o.prototype, property, {\n//     get: getter,\n//     enumerable: false,\n//     configurable: false\n//   });\n// }\n\n\nfunction toGuard(condition, guardMap) {\n  if (!condition) {\n    return undefined;\n  }\n\n  if (isString(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition,\n      predicate: guardMap ? guardMap[condition] : undefined\n    };\n  }\n\n  if (isFunction(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition.name,\n      predicate: condition\n    };\n  }\n\n  return condition;\n}\n\nfunction isObservable(value) {\n  try {\n    return 'subscribe' in value && isFunction(value.subscribe);\n  } catch (e) {\n    return false;\n  }\n}\n\nvar symbolObservable =\n/*#__PURE__*/\nfunction () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n\nfunction isMachine(value) {\n  try {\n    return '__xstatenode' in value;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar uniqueId =\n/*#__PURE__*/\nfunction () {\n  var currentId = 0;\n  return function () {\n    currentId++;\n    return currentId.toString(16);\n  };\n}();\n\nfunction toEventObject(event, payload // id?: TEvent['type']\n) {\n  if (isString(event) || typeof event === 'number') {\n    return __assign({\n      type: event\n    }, payload);\n  }\n\n  return event;\n}\n\nfunction toSCXMLEvent(event, scxmlEvent) {\n  if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n    return event;\n  }\n\n  var eventObject = toEventObject(event);\n  return __assign({\n    name: eventObject.type,\n    data: eventObject,\n    $$type: 'scxml',\n    type: 'external'\n  }, scxmlEvent);\n}\n\nfunction toTransitionConfigArray(event, configLike) {\n  var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string' || isMachine(transitionLike)) {\n      // @ts-ignore until Type instantiation is excessively deep and possibly infinite bug is fixed\n      return {\n        target: transitionLike,\n        event: event\n      };\n    }\n\n    return __assign(__assign({}, transitionLike), {\n      event: event\n    });\n  });\n  return transitions;\n}\n\nfunction normalizeTarget(target) {\n  if (target === undefined || target === TARGETLESS_KEY) {\n    return undefined;\n  }\n\n  return toArray(target);\n}\n\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n  if (!IS_PRODUCTION) {\n    var originalStackTrace = originalError.stack ? \" Stacktrace was '\" + originalError.stack + \"'\" : '';\n\n    if (originalError === currentError) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Missing onError handler for invocation '\" + id + \"', error was '\" + originalError + \"'.\" + originalStackTrace);\n    } else {\n      var stackTrace = currentError.stack ? \" Stacktrace was '\" + currentError.stack + \"'\" : ''; // tslint:disable-next-line:no-console\n\n      console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\" + id + \"'. \" + (\"Original error: '\" + originalError + \"'. \" + originalStackTrace + \" Current error is '\" + currentError + \"'.\" + stackTrace));\n    }\n  }\n}\n\nexport { flatten, getEventType, isArray, isBuiltInEvent, isFunction, isMachine, isObservable, isPromiseLike, isStateLike, isString, keys, mapContext, mapFilterValues, mapValues, matchesState, nestedPath, normalizeTarget, partition, path, pathToStateValue, reportUnhandledExceptionOnInvocation, symbolObservable, toArray, toArrayStrict, toEventObject, toGuard, toSCXMLEvent, toStatePath, toStatePaths, toStateValue, toTransitionConfigArray, uniqueId, updateContext, updateHistoryStates, updateHistoryValue, warn };","var ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[\"Start\"] = \"xstate.start\";\n  ActionTypes[\"Stop\"] = \"xstate.stop\";\n  ActionTypes[\"Raise\"] = \"xstate.raise\";\n  ActionTypes[\"Send\"] = \"xstate.send\";\n  ActionTypes[\"Cancel\"] = \"xstate.cancel\";\n  ActionTypes[\"NullEvent\"] = \"\";\n  ActionTypes[\"Assign\"] = \"xstate.assign\";\n  ActionTypes[\"After\"] = \"xstate.after\";\n  ActionTypes[\"DoneState\"] = \"done.state\";\n  ActionTypes[\"DoneInvoke\"] = \"done.invoke\";\n  ActionTypes[\"Log\"] = \"xstate.log\";\n  ActionTypes[\"Init\"] = \"xstate.init\";\n  ActionTypes[\"Invoke\"] = \"xstate.invoke\";\n  ActionTypes[\"ErrorExecution\"] = \"error.execution\";\n  ActionTypes[\"ErrorCommunication\"] = \"error.communication\";\n  ActionTypes[\"ErrorPlatform\"] = \"error.platform\";\n  ActionTypes[\"ErrorCustom\"] = \"xstate.error\";\n  ActionTypes[\"Update\"] = \"xstate.update\";\n  ActionTypes[\"Pure\"] = \"xstate.pure\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar SpecialTargets;\n\n(function (SpecialTargets) {\n  SpecialTargets[\"Parent\"] = \"#_parent\";\n  SpecialTargets[\"Internal\"] = \"#_internal\";\n})(SpecialTargets || (SpecialTargets = {}));\n\nexport { ActionTypes, SpecialTargets };","import { ActionTypes } from './types.js'; // xstate-specific action types\n\nvar start = ActionTypes.Start;\nvar stop = ActionTypes.Stop;\nvar raise = ActionTypes.Raise;\nvar send = ActionTypes.Send;\nvar cancel = ActionTypes.Cancel;\nvar nullEvent = ActionTypes.NullEvent;\nvar assign = ActionTypes.Assign;\nvar after = ActionTypes.After;\nvar doneState = ActionTypes.DoneState;\nvar log = ActionTypes.Log;\nvar init = ActionTypes.Init;\nvar invoke = ActionTypes.Invoke;\nvar errorExecution = ActionTypes.ErrorExecution;\nvar errorPlatform = ActionTypes.ErrorPlatform;\nvar error = ActionTypes.ErrorCustom;\nvar update = ActionTypes.Update;\nvar pure = ActionTypes.Pure;\nexport { after, assign, cancel, doneState, error, errorExecution, errorPlatform, init, invoke, log, nullEvent, pure, raise, send, start, stop, update };","import { __assign, __rest } from './_virtual/_tslib.js';\nimport { toSCXMLEvent, isFunction, toEventObject, getEventType, isString, isArray } from './utils.js';\nimport { SpecialTargets, ActionTypes } from './types.js';\nimport { send as send$1, update, assign as assign$1, raise as raise$1, init, log as log$1, cancel as cancel$1, error as error$1 } from './actionTypes.js';\nvar initEvent =\n/*#__PURE__*/\ntoSCXMLEvent({\n  type: init\n});\n\nfunction getActionFunction(actionType, actionFunctionMap) {\n  return actionFunctionMap ? actionFunctionMap[actionType] || undefined : undefined;\n}\n\nfunction toActionObject(action, actionFunctionMap) {\n  var actionObject;\n\n  if (isString(action) || typeof action === 'number') {\n    var exec = getActionFunction(action, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = {\n        type: action,\n        exec: exec\n      };\n    } else if (exec) {\n      actionObject = exec;\n    } else {\n      actionObject = {\n        type: action,\n        exec: undefined\n      };\n    }\n  } else if (isFunction(action)) {\n    actionObject = {\n      // Convert action to string if unnamed\n      type: action.name || action.toString(),\n      exec: action\n    };\n  } else {\n    var exec = getActionFunction(action.type, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = __assign(__assign({}, action), {\n        exec: exec\n      });\n    } else if (exec) {\n      var type = action.type,\n          other = __rest(action, [\"type\"]);\n\n      actionObject = __assign(__assign({\n        type: type\n      }, exec), other);\n    } else {\n      actionObject = action;\n    }\n  }\n\n  Object.defineProperty(actionObject, 'toString', {\n    value: function () {\n      return actionObject.type;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return actionObject;\n}\n\nvar toActionObjects = function (action, actionFunctionMap) {\n  if (!action) {\n    return [];\n  }\n\n  var actions = isArray(action) ? action : [action];\n  return actions.map(function (subAction) {\n    return toActionObject(subAction, actionFunctionMap);\n  });\n};\n\nfunction toActivityDefinition(action) {\n  var actionObject = toActionObject(action);\n  return __assign(__assign({\n    id: isString(action) ? action : actionObject.id\n  }, actionObject), {\n    type: actionObject.type\n  });\n}\n/**\r\n * Raises an event. This places the event in the internal event queue, so that\r\n * the event is immediately consumed by the machine in the current step.\r\n *\r\n * @param eventType The event to raise.\r\n */\n\n\nfunction raise(event) {\n  if (!isString(event)) {\n    return send(event, {\n      to: SpecialTargets.Internal\n    });\n  }\n\n  return {\n    type: raise$1,\n    event: event\n  };\n}\n\nfunction resolveRaise(action) {\n  return {\n    type: raise$1,\n    _event: toSCXMLEvent(action.event)\n  };\n}\n/**\r\n * Sends an event. This returns an action that will be read by an interpreter to\r\n * send the event in the next step, after the current step is finished executing.\r\n *\r\n * @param event The event to send.\r\n * @param options Options to pass into the send event:\r\n *  - `id` - The unique send event identifier (used with `cancel()`).\r\n *  - `delay` - The number of milliseconds to delay the sending of the event.\r\n *  - `to` - The target of this event (by default, the machine the event was sent from).\r\n */\n\n\nfunction send(event, options) {\n  return {\n    to: options ? options.to : undefined,\n    type: send$1,\n    event: isFunction(event) ? event : toEventObject(event),\n    delay: options ? options.delay : undefined,\n    id: options && options.id !== undefined ? options.id : isFunction(event) ? event.name : getEventType(event)\n  };\n}\n\nfunction resolveSend(action, ctx, _event, delaysMap) {\n  var meta = {\n    _event: _event\n  }; // TODO: helper function for resolving Expr\n\n  var resolvedEvent = toSCXMLEvent(isFunction(action.event) ? action.event(ctx, _event.data, meta) : action.event);\n  var resolvedDelay;\n\n  if (isString(action.delay)) {\n    var configDelay = delaysMap && delaysMap[action.delay];\n    resolvedDelay = isFunction(configDelay) ? configDelay(ctx, _event.data, meta) : configDelay;\n  } else {\n    resolvedDelay = isFunction(action.delay) ? action.delay(ctx, _event.data, meta) : action.delay;\n  }\n\n  var resolvedTarget = isFunction(action.to) ? action.to(ctx, _event.data, meta) : action.to;\n  return __assign(__assign({}, action), {\n    to: resolvedTarget,\n    _event: resolvedEvent,\n    event: resolvedEvent.data,\n    delay: resolvedDelay\n  });\n}\n/**\r\n * Sends an event to this machine's parent.\r\n *\r\n * @param event The event to send to the parent machine.\r\n * @param options Options to pass into the send event.\r\n */\n\n\nfunction sendParent(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n/**\r\n * Sends an update event to this machine's parent.\r\n */\n\n\nfunction sendUpdate() {\n  return sendParent(update);\n}\n/**\r\n * Sends an event back to the sender of the original event.\r\n *\r\n * @param event The event to send back to the sender\r\n * @param options Options to pass into the send event\r\n */\n\n\nfunction respond(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: function (_, __, _a) {\n      var _event = _a._event;\n      return _event.origin; // TODO: handle when _event.origin is undefined\n    }\n  }));\n}\n\nvar defaultLogExpr = function (context, event) {\n  return {\n    context: context,\n    event: event\n  };\n};\n/**\r\n *\r\n * @param expr The expression function to evaluate which will be logged.\r\n *  Takes in 2 arguments:\r\n *  - `ctx` - the current state context\r\n *  - `event` - the event that caused this action to be executed.\r\n * @param label The label to give to the logged expression.\r\n */\n\n\nfunction log(expr, label) {\n  if (expr === void 0) {\n    expr = defaultLogExpr;\n  }\n\n  return {\n    type: log$1,\n    label: label,\n    expr: expr\n  };\n}\n\nvar resolveLog = function (action, ctx, _event) {\n  return __assign(__assign({}, action), {\n    value: isString(action.expr) ? action.expr : action.expr(ctx, _event.data, {\n      _event: _event\n    })\n  });\n};\n/**\r\n * Cancels an in-flight `send(...)` action. A canceled sent action will not\r\n * be executed, nor will its event be sent, unless it has already been sent\r\n * (e.g., if `cancel(...)` is called after the `send(...)` action's `delay`).\r\n *\r\n * @param sendId The `id` of the `send(...)` action to cancel.\r\n */\n\n\nvar cancel = function (sendId) {\n  return {\n    type: cancel$1,\n    sendId: sendId\n  };\n};\n/**\r\n * Starts an activity.\r\n *\r\n * @param activity The activity to start.\r\n */\n\n\nfunction start(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Start,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Stops an activity.\r\n *\r\n * @param activity The activity to stop.\r\n */\n\n\nfunction stop(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Stop,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Updates the current context of the machine.\r\n *\r\n * @param assignment An object that represents the partial context to update.\r\n */\n\n\nvar assign = function (assignment) {\n  return {\n    type: assign$1,\n    assignment: assignment\n  };\n};\n/**\r\n * Returns an event type that represents an implicit event that\r\n * is sent after the specified `delay`.\r\n *\r\n * @param delayRef The delay in milliseconds\r\n * @param id The state node ID where this event is handled\r\n */\n\n\nfunction after(delayRef, id) {\n  var idSuffix = id ? \"#\" + id : '';\n  return ActionTypes.After + \"(\" + delayRef + \")\" + idSuffix;\n}\n/**\r\n * Returns an event that represents that a final state node\r\n * has been reached in the parent state node.\r\n *\r\n * @param id The final state node's parent state node `id`\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction done(id, data) {\n  var type = ActionTypes.DoneState + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n/**\r\n * Returns an event that represents that an invoked service has terminated.\r\n *\r\n * An invoked service is terminated when it has reached a top-level final state node,\r\n * but not when it is canceled.\r\n *\r\n * @param id The final state node ID\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction doneInvoke(id, data) {\n  var type = ActionTypes.DoneInvoke + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n\nfunction error(id, data) {\n  var type = ActionTypes.ErrorPlatform + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n/**\r\n * Forwards (sends) an event to a specified service.\r\n *\r\n * @param target The target service to forward the event to.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction forwardTo(target, options) {\n  return send(function (_, event) {\n    return event;\n  }, __assign(__assign({}, options), {\n    to: target\n  }));\n}\n/**\r\n * Escalates an error by sending it as an event to this machine's parent.\r\n *\r\n * @param errorData The error data to send.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction escalate(errorData, options) {\n  return sendParent({\n    type: error$1,\n    data: errorData\n  }, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n\nexport { after, assign, cancel, done, doneInvoke, error, escalate, forwardTo, getActionFunction, initEvent, log, raise, resolveLog, resolveRaise, resolveSend, respond, send, sendParent, sendUpdate, start, stop, toActionObject, toActionObjects, toActivityDefinition };","import { __values, __spread } from './_virtual/_tslib.js';\nimport { keys, flatten } from './utils.js';\n\nvar isLeafNode = function (stateNode) {\n  return stateNode.type === 'atomic' || stateNode.type === 'final';\n};\n\nfunction getChildren(stateNode) {\n  return keys(stateNode.states).map(function (key) {\n    return stateNode.states[key];\n  });\n}\n\nfunction getAllStateNodes(stateNode) {\n  var stateNodes = [stateNode];\n\n  if (isLeafNode(stateNode)) {\n    return stateNodes;\n  }\n\n  return stateNodes.concat(flatten(getChildren(stateNode).map(getAllStateNodes)));\n}\n\nfunction getConfiguration(prevStateNodes, stateNodes) {\n  var e_1, _a, e_2, _b, e_3, _c, e_4, _d;\n\n  var prevConfiguration = new Set(prevStateNodes);\n  var prevAdjList = getAdjList(prevConfiguration);\n  var configuration = new Set(stateNodes);\n\n  try {\n    // add all ancestors\n    for (var configuration_1 = __values(configuration), configuration_1_1 = configuration_1.next(); !configuration_1_1.done; configuration_1_1 = configuration_1.next()) {\n      var s = configuration_1_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (configuration_1_1 && !configuration_1_1.done && (_a = configuration_1.return)) _a.call(configuration_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  var adjList = getAdjList(configuration);\n\n  try {\n    // add descendants\n    for (var configuration_2 = __values(configuration), configuration_2_1 = configuration_2.next(); !configuration_2_1.done; configuration_2_1 = configuration_2.next()) {\n      var s = configuration_2_1.value; // if previously active, add existing child nodes\n\n      if (s.type === 'compound' && (!adjList.get(s) || !adjList.get(s).length)) {\n        if (prevAdjList.get(s)) {\n          prevAdjList.get(s).forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        } else {\n          s.initialStateNodes.forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        }\n      } else {\n        if (s.type === 'parallel') {\n          try {\n            for (var _e = (e_3 = void 0, __values(getChildren(s))), _f = _e.next(); !_f.done; _f = _e.next()) {\n              var child = _f.value;\n\n              if (child.type === 'history') {\n                continue;\n              }\n\n              if (!configuration.has(child)) {\n                configuration.add(child);\n\n                if (prevAdjList.get(child)) {\n                  prevAdjList.get(child).forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                } else {\n                  child.initialStateNodes.forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                }\n              }\n            }\n          } catch (e_3_1) {\n            e_3 = {\n              error: e_3_1\n            };\n          } finally {\n            try {\n              if (_f && !_f.done && (_c = _e.return)) _c.call(_e);\n            } finally {\n              if (e_3) throw e_3.error;\n            }\n          }\n        }\n      }\n    }\n  } catch (e_2_1) {\n    e_2 = {\n      error: e_2_1\n    };\n  } finally {\n    try {\n      if (configuration_2_1 && !configuration_2_1.done && (_b = configuration_2.return)) _b.call(configuration_2);\n    } finally {\n      if (e_2) throw e_2.error;\n    }\n  }\n\n  try {\n    // add all ancestors\n    for (var configuration_3 = __values(configuration), configuration_3_1 = configuration_3.next(); !configuration_3_1.done; configuration_3_1 = configuration_3.next()) {\n      var s = configuration_3_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_4_1) {\n    e_4 = {\n      error: e_4_1\n    };\n  } finally {\n    try {\n      if (configuration_3_1 && !configuration_3_1.done && (_d = configuration_3.return)) _d.call(configuration_3);\n    } finally {\n      if (e_4) throw e_4.error;\n    }\n  }\n\n  return configuration;\n}\n\nfunction getValueFromAdj(baseNode, adjList) {\n  var childStateNodes = adjList.get(baseNode);\n\n  if (!childStateNodes) {\n    return {}; // todo: fix?\n  }\n\n  if (baseNode.type === 'compound') {\n    var childStateNode = childStateNodes[0];\n\n    if (childStateNode) {\n      if (isLeafNode(childStateNode)) {\n        return childStateNode.key;\n      }\n    } else {\n      return {};\n    }\n  }\n\n  var stateValue = {};\n  childStateNodes.forEach(function (csn) {\n    stateValue[csn.key] = getValueFromAdj(csn, adjList);\n  });\n  return stateValue;\n}\n\nfunction getAdjList(configuration) {\n  var e_5, _a;\n\n  var adjList = new Map();\n\n  try {\n    for (var configuration_4 = __values(configuration), configuration_4_1 = configuration_4.next(); !configuration_4_1.done; configuration_4_1 = configuration_4.next()) {\n      var s = configuration_4_1.value;\n\n      if (!adjList.has(s)) {\n        adjList.set(s, []);\n      }\n\n      if (s.parent) {\n        if (!adjList.has(s.parent)) {\n          adjList.set(s.parent, []);\n        }\n\n        adjList.get(s.parent).push(s);\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (configuration_4_1 && !configuration_4_1.done && (_a = configuration_4.return)) _a.call(configuration_4);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return adjList;\n}\n\nfunction getValue(rootNode, configuration) {\n  var config = getConfiguration([rootNode], configuration);\n  return getValueFromAdj(rootNode, getAdjList(config));\n}\n\nfunction has(iterable, item) {\n  if (Array.isArray(iterable)) {\n    return iterable.some(function (member) {\n      return member === item;\n    });\n  }\n\n  if (iterable instanceof Set) {\n    return iterable.has(item);\n  }\n\n  return false; // TODO: fix\n}\n\nfunction nextEvents(configuration) {\n  return flatten(__spread(new Set(configuration.map(function (sn) {\n    return sn.ownEvents;\n  }))));\n}\n\nfunction isInFinalState(configuration, stateNode) {\n  if (stateNode.type === 'compound') {\n    return getChildren(stateNode).some(function (s) {\n      return s.type === 'final' && has(configuration, s);\n    });\n  }\n\n  if (stateNode.type === 'parallel') {\n    return getChildren(stateNode).every(function (sn) {\n      return isInFinalState(configuration, sn);\n    });\n  }\n\n  return false;\n}\n\nexport { getAdjList, getAllStateNodes, getChildren, getConfiguration, getValue, has, isInFinalState, isLeafNode, nextEvents };","import { __spread, __rest, __assign } from './_virtual/_tslib.js';\nimport { EMPTY_ACTIVITY_MAP } from './constants.js';\nimport { isString, matchesState, keys } from './utils.js';\nimport { nextEvents } from './stateUtils.js';\nimport { initEvent } from './actions.js';\n\nfunction stateValuesEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a === undefined || b === undefined) {\n    return false;\n  }\n\n  if (isString(a) || isString(b)) {\n    return a === b;\n  }\n\n  var aKeys = keys(a);\n  var bKeys = keys(b);\n  return aKeys.length === bKeys.length && aKeys.every(function (key) {\n    return stateValuesEqual(a[key], b[key]);\n  });\n}\n\nfunction isState(state) {\n  if (isString(state)) {\n    return false;\n  }\n\n  return 'value' in state && 'history' in state;\n}\n\nfunction bindActionToState(action, state) {\n  var exec = action.exec;\n\n  var boundAction = __assign(__assign({}, action), {\n    exec: exec !== undefined ? function () {\n      return exec(state.context, state.event, {\n        action: action,\n        state: state,\n        _event: state._event\n      });\n    } : undefined\n  });\n\n  return boundAction;\n}\n\nvar State =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new State instance.\r\n   * @param value The state value\r\n   * @param context The extended state\r\n   * @param historyValue The tree representing historical values of the state nodes\r\n   * @param history The previous state\r\n   * @param actions An array of action objects to execute as side-effects\r\n   * @param activities A mapping of activities and whether they are started (`true`) or stopped (`false`).\r\n   * @param meta\r\n   * @param events Internal event queue. Should be empty with run-to-completion semantics.\r\n   * @param configuration\r\n   */\n  function State(config) {\n    this.actions = [];\n    this.activities = EMPTY_ACTIVITY_MAP;\n    this.meta = {};\n    this.events = [];\n    this.value = config.value;\n    this.context = config.context;\n    this._event = config._event;\n    this._sessionid = config._sessionid;\n    this.event = this._event.data;\n    this.historyValue = config.historyValue;\n    this.history = config.history;\n    this.actions = config.actions || [];\n    this.activities = config.activities || EMPTY_ACTIVITY_MAP;\n    this.meta = config.meta || {};\n    this.events = config.events || [];\n    this.matches = this.matches.bind(this);\n    this.toStrings = this.toStrings.bind(this);\n    this.configuration = config.configuration;\n    this.transitions = config.transitions;\n    this.children = config.children;\n    this.done = !!config.done;\n    Object.defineProperty(this, 'nextEvents', {\n      get: function () {\n        return nextEvents(config.configuration);\n      }\n    });\n  }\n  /**\r\n   * Creates a new State instance for the given `stateValue` and `context`.\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.from = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (stateValue.context !== context) {\n        return new State({\n          value: stateValue.value,\n          context: context,\n          _event: stateValue._event,\n          _sessionid: null,\n          historyValue: stateValue.historyValue,\n          history: stateValue.history,\n          actions: [],\n          activities: stateValue.activities,\n          meta: {},\n          events: [],\n          configuration: [],\n          transitions: [],\n          children: {}\n        });\n      }\n\n      return stateValue;\n    }\n\n    var _event = initEvent;\n    return new State({\n      value: stateValue,\n      context: context,\n      _event: _event,\n      _sessionid: null,\n      historyValue: undefined,\n      history: undefined,\n      actions: [],\n      activities: undefined,\n      meta: undefined,\n      events: [],\n      configuration: [],\n      transitions: [],\n      children: {}\n    });\n  };\n  /**\r\n   * Creates a new State instance for the given `config`.\r\n   * @param config The state config\r\n   */\n\n\n  State.create = function (config) {\n    return new State(config);\n  };\n  /**\r\n   * Creates a new `State` instance for the given `stateValue` and `context` with no actions (side-effects).\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.inert = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (!stateValue.actions.length) {\n        return stateValue;\n      }\n\n      var _event = initEvent;\n      return new State({\n        value: stateValue.value,\n        context: context,\n        _event: _event,\n        _sessionid: null,\n        historyValue: stateValue.historyValue,\n        history: stateValue.history,\n        activities: stateValue.activities,\n        configuration: stateValue.configuration,\n        transitions: [],\n        children: {}\n      });\n    }\n\n    return State.from(stateValue, context);\n  };\n  /**\r\n   * Returns an array of all the string leaf state node paths.\r\n   * @param stateValue\r\n   * @param delimiter The character(s) that separate each subpath in the string state node path.\r\n   */\n\n\n  State.prototype.toStrings = function (stateValue, delimiter) {\n    var _this = this;\n\n    if (stateValue === void 0) {\n      stateValue = this.value;\n    }\n\n    if (delimiter === void 0) {\n      delimiter = '.';\n    }\n\n    if (isString(stateValue)) {\n      return [stateValue];\n    }\n\n    var valueKeys = keys(stateValue);\n    return valueKeys.concat.apply(valueKeys, __spread(valueKeys.map(function (key) {\n      return _this.toStrings(stateValue[key], delimiter).map(function (s) {\n        return key + delimiter + s;\n      });\n    })));\n  };\n\n  State.prototype.toJSON = function () {\n    var _a = this,\n        configuration = _a.configuration,\n        transitions = _a.transitions,\n        jsonValues = __rest(_a, [\"configuration\", \"transitions\"]);\n\n    return jsonValues;\n  };\n  /**\r\n   * Whether the current state value is a subset of the given parent state value.\r\n   * @param parentStateValue\r\n   */\n\n\n  State.prototype.matches = function (parentStateValue) {\n    return matchesState(parentStateValue, this.value);\n  };\n\n  return State;\n}();\n\nexport { State, bindActionToState, isState, stateValuesEqual };","function createNullActor(id) {\n  return {\n    id: id,\n    send: function () {\n      return void 0;\n    },\n    subscribe: function () {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    },\n    toJSON: function () {\n      return {\n        id: id\n      };\n    }\n  };\n}\n/**\r\n * Creates a null actor that is able to be invoked given the provided\r\n * invocation information in its `.meta` value.\r\n *\r\n * @param invokeDefinition The meta information needed to invoke the actor.\r\n */\n\n\nfunction createInvocableActor(invokeDefinition) {\n  var tempActor = createNullActor(invokeDefinition.id);\n  tempActor.meta = invokeDefinition;\n  return tempActor;\n}\n\nfunction isActor(item) {\n  try {\n    return typeof item.send === 'function';\n  } catch (e) {\n    return false;\n  }\n}\n\nexport { createInvocableActor, createNullActor, isActor };","import { __assign, __values, __spread, __read, __rest } from './_virtual/_tslib.js';\nimport { DEFAULT_GUARD_TYPE, STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { mapValues, isArray, flatten, keys, toArray, toStateValue, isString, getEventType, matchesState, path, mapContext, toSCXMLEvent, pathToStateValue, isBuiltInEvent, partition, updateContext, warn, updateHistoryValue, toStatePath, mapFilterValues, toStatePaths, nestedPath, normalizeTarget, toGuard, toTransitionConfigArray, isMachine, isFunction } from './utils.js';\nimport { SpecialTargets } from './types.js';\nimport { getAllStateNodes, getConfiguration, has, getChildren, isInFinalState, getValue, isLeafNode } from './stateUtils.js';\nimport { start as start$1, stop as stop$1, pure, log, send, raise as raise$1, invoke, update, nullEvent, assign } from './actionTypes.js';\nimport { done, start, raise, stop, toActionObjects, toActionObject, resolveLog, resolveSend, resolveRaise, doneInvoke, error, toActivityDefinition, after, send as send$1, cancel, initEvent } from './actions.js';\nimport { State, stateValuesEqual } from './State.js';\nimport { createInvocableActor } from './Actor.js';\nvar NULL_EVENT = '';\nvar STATE_IDENTIFIER = '#';\nvar WILDCARD = '*';\nvar EMPTY_OBJECT = {};\n\nvar isStateId = function (str) {\n  return str[0] === STATE_IDENTIFIER;\n};\n\nvar createDefaultOptions = function () {\n  return {\n    actions: {},\n    guards: {},\n    services: {},\n    activities: {},\n    delays: {}\n  };\n};\n\nvar validateArrayifiedTransitions = function (stateNode, event, transitions) {\n  var hasNonLastUnguardedTarget = transitions.slice(0, -1).some(function (transition) {\n    return !('cond' in transition) && !('in' in transition) && (isString(transition.target) || isMachine(transition.target));\n  });\n  var eventText = event === NULL_EVENT ? 'the transient event' : \"event '\" + event + \"'\";\n  warn(!hasNonLastUnguardedTarget, \"One or more transitions for \" + eventText + \" on state '\" + stateNode.id + \"' are unreachable. \" + \"Make sure that the default transition is the last one defined.\");\n};\n\nvar StateNode =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function StateNode(\n  /**\r\n   * The raw config used to create the machine.\r\n   */\n  config, options,\n  /**\r\n   * The initial extended state\r\n   */\n  context) {\n    var _this = this;\n\n    this.config = config;\n    this.context = context;\n    /**\r\n     * The order this state node appears. Corresponds to the implicit SCXML document order.\r\n     */\n\n    this.order = -1;\n    this.__xstatenode = true;\n    this.__cache = {\n      events: undefined,\n      relativeValue: new Map(),\n      initialStateValue: undefined,\n      initialState: undefined,\n      on: undefined,\n      transitions: undefined,\n      candidates: {},\n      delayedTransitions: undefined\n    };\n    this.idMap = {};\n    this.options = Object.assign(createDefaultOptions(), options);\n    this.parent = this.options._parent;\n    this.key = this.config.key || this.options._key || this.config.id || '(machine)';\n    this.machine = this.parent ? this.parent.machine : this;\n    this.path = this.parent ? this.parent.path.concat(this.key) : [];\n    this.delimiter = this.config.delimiter || (this.parent ? this.parent.delimiter : STATE_DELIMITER);\n    this.id = this.config.id || __spread([this.machine.key], this.path).join(this.delimiter);\n    this.version = this.parent ? this.parent.version : this.config.version;\n    this.type = this.config.type || (this.config.parallel ? 'parallel' : this.config.states && keys(this.config.states).length ? 'compound' : this.config.history ? 'history' : 'atomic');\n\n    if (!IS_PRODUCTION) {\n      warn(!('parallel' in this.config), \"The \\\"parallel\\\" property is deprecated and will be removed in version 4.1. \" + (this.config.parallel ? \"Replace with `type: 'parallel'`\" : \"Use `type: '\" + this.type + \"'`\") + \" in the config for state node '\" + this.id + \"' instead.\");\n    }\n\n    this.initial = this.config.initial;\n    this.states = this.config.states ? mapValues(this.config.states, function (stateConfig, key) {\n      var _a;\n\n      var stateNode = new StateNode(stateConfig, {\n        _parent: _this,\n        _key: key\n      });\n      Object.assign(_this.idMap, __assign((_a = {}, _a[stateNode.id] = stateNode, _a), stateNode.idMap));\n      return stateNode;\n    }) : EMPTY_OBJECT; // Document order\n\n    var order = 0;\n\n    function dfs(stateNode) {\n      var e_1, _a;\n\n      stateNode.order = order++;\n\n      try {\n        for (var _b = __values(getChildren(stateNode)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n          dfs(child);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n\n    dfs(this); // History config\n\n    this.history = this.config.history === true ? 'shallow' : this.config.history || false;\n    this._transient = !this.config.on ? false : Array.isArray(this.config.on) ? this.config.on.some(function (_a) {\n      var event = _a.event;\n      return event === NULL_EVENT;\n    }) : NULL_EVENT in this.config.on;\n    this.strict = !!this.config.strict; // TODO: deprecate (entry)\n\n    this.onEntry = toArray(this.config.entry || this.config.onEntry).map(function (action) {\n      return toActionObject(action);\n    }); // TODO: deprecate (exit)\n\n    this.onExit = toArray(this.config.exit || this.config.onExit).map(function (action) {\n      return toActionObject(action);\n    });\n    this.meta = this.config.meta;\n    this.data = this.type === 'final' ? this.config.data : undefined;\n    this.invoke = toArray(this.config.invoke).map(function (invokeConfig, i) {\n      var _a, _b;\n\n      if (isMachine(invokeConfig)) {\n        _this.machine.options.services = __assign((_a = {}, _a[invokeConfig.id] = invokeConfig, _a), _this.machine.options.services);\n        return {\n          type: invoke,\n          src: invokeConfig.id,\n          id: invokeConfig.id\n        };\n      } else if (typeof invokeConfig.src !== 'string') {\n        var invokeSrc = _this.id + \":invocation[\" + i + \"]\"; // TODO: util function\n\n        _this.machine.options.services = __assign((_b = {}, _b[invokeSrc] = invokeConfig.src, _b), _this.machine.options.services);\n        return __assign(__assign({\n          type: invoke,\n          id: invokeSrc\n        }, invokeConfig), {\n          src: invokeSrc\n        });\n      } else {\n        return __assign(__assign({}, invokeConfig), {\n          type: invoke,\n          id: invokeConfig.id || invokeConfig.src,\n          src: invokeConfig.src\n        });\n      }\n    });\n    this.activities = toArray(this.config.activities).concat(this.invoke).map(function (activity) {\n      return toActivityDefinition(activity);\n    });\n    this.transition = this.transition.bind(this);\n  }\n\n  StateNode.prototype._init = function () {\n    if (this.__cache.transitions) {\n      return;\n    }\n\n    getAllStateNodes(this).forEach(function (stateNode) {\n      return stateNode.on;\n    });\n  };\n  /**\r\n   * Clones this state machine with custom options and context.\r\n   *\r\n   * @param options Options (actions, guards, activities, services) to recursively merge with the existing options.\r\n   * @param context Custom context (will override predefined context)\r\n   */\n\n\n  StateNode.prototype.withConfig = function (options, context) {\n    if (context === void 0) {\n      context = this.context;\n    }\n\n    var _a = this.options,\n        actions = _a.actions,\n        activities = _a.activities,\n        guards = _a.guards,\n        services = _a.services,\n        delays = _a.delays;\n    return new StateNode(this.config, {\n      actions: __assign(__assign({}, actions), options.actions),\n      activities: __assign(__assign({}, activities), options.activities),\n      guards: __assign(__assign({}, guards), options.guards),\n      services: __assign(__assign({}, services), options.services),\n      delays: __assign(__assign({}, delays), options.delays)\n    }, context);\n  };\n  /**\r\n   * Clones this state machine with custom context.\r\n   *\r\n   * @param context Custom context (will override predefined context, not recursive)\r\n   */\n\n\n  StateNode.prototype.withContext = function (context) {\n    return new StateNode(this.config, this.options, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"definition\", {\n    /**\r\n     * The well-structured state node definition.\r\n     */\n    get: function () {\n      return {\n        id: this.id,\n        key: this.key,\n        version: this.version,\n        type: this.type,\n        initial: this.initial,\n        history: this.history,\n        states: mapValues(this.states, function (state) {\n          return state.definition;\n        }),\n        on: this.on,\n        transitions: this.transitions,\n        onEntry: this.onEntry,\n        onExit: this.onExit,\n        activities: this.activities || [],\n        meta: this.meta,\n        order: this.order || -1,\n        data: this.data,\n        invoke: this.invoke\n      };\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.toJSON = function () {\n    return this.definition;\n  };\n\n  Object.defineProperty(StateNode.prototype, \"on\", {\n    /**\r\n     * The mapping of events to transitions.\r\n     */\n    get: function () {\n      if (this.__cache.on) {\n        return this.__cache.on;\n      }\n\n      var transitions = this.transitions;\n      return this.__cache.on = transitions.reduce(function (map, transition) {\n        map[transition.eventType] = map[transition.eventType] || [];\n        map[transition.eventType].push(transition);\n        return map;\n      }, {});\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"after\", {\n    get: function () {\n      return this.__cache.delayedTransitions || (this.__cache.delayedTransitions = this.getDelayedTransitions(), this.__cache.delayedTransitions);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"transitions\", {\n    /**\r\n     * All the transitions that can be taken from this state node.\r\n     */\n    get: function () {\n      return this.__cache.transitions || (this.__cache.transitions = this.formatTransitions(), this.__cache.transitions);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.getCandidates = function (eventName) {\n    if (this.__cache.candidates[eventName]) {\n      return this.__cache.candidates[eventName];\n    }\n\n    var transient = eventName === NULL_EVENT;\n    var candidates = this.transitions.filter(function (transition) {\n      var sameEventType = transition.eventType === eventName; // null events should only match against eventless transitions\n\n      return transient ? sameEventType : sameEventType || transition.eventType === WILDCARD;\n    });\n    this.__cache.candidates[eventName] = candidates;\n    return candidates;\n  };\n  /**\r\n   * All delayed transitions from the config.\r\n   */\n\n\n  StateNode.prototype.getDelayedTransitions = function () {\n    var _this = this;\n\n    var afterConfig = this.config.after;\n\n    if (!afterConfig) {\n      return [];\n    }\n\n    var mutateEntryExit = function (delay, i) {\n      var delayRef = isFunction(delay) ? _this.id + \":delay[\" + i + \"]\" : delay;\n      var eventType = after(delayRef, _this.id);\n\n      _this.onEntry.push(send$1(eventType, {\n        delay: delay\n      }));\n\n      _this.onExit.push(cancel(eventType));\n\n      return eventType;\n    };\n\n    var delayedTransitions = isArray(afterConfig) ? afterConfig.map(function (transition, i) {\n      var eventType = mutateEntryExit(transition.delay, i);\n      return __assign(__assign({}, transition), {\n        event: eventType\n      });\n    }) : flatten(keys(afterConfig).map(function (delay, i) {\n      var configTransition = afterConfig[delay];\n      var resolvedTransition = isString(configTransition) ? {\n        target: configTransition\n      } : configTransition;\n      var resolvedDelay = !isNaN(+delay) ? +delay : delay;\n      var eventType = mutateEntryExit(resolvedDelay, i);\n      return toArray(resolvedTransition).map(function (transition) {\n        return __assign(__assign({}, transition), {\n          event: eventType,\n          delay: resolvedDelay\n        });\n      });\n    }));\n    return delayedTransitions.map(function (delayedTransition) {\n      var delay = delayedTransition.delay;\n      return __assign(__assign({}, _this.formatTransition(delayedTransition)), {\n        delay: delay\n      });\n    });\n  };\n  /**\r\n   * Returns the state nodes represented by the current state value.\r\n   *\r\n   * @param state The state value or State instance\r\n   */\n\n\n  StateNode.prototype.getStateNodes = function (state) {\n    var _a;\n\n    var _this = this;\n\n    if (!state) {\n      return [];\n    }\n\n    var stateValue = state instanceof State ? state.value : toStateValue(state, this.delimiter);\n\n    if (isString(stateValue)) {\n      var initialStateValue = this.getStateNode(stateValue).initial;\n      return initialStateValue !== undefined ? this.getStateNodes((_a = {}, _a[stateValue] = initialStateValue, _a)) : [this.states[stateValue]];\n    }\n\n    var subStateKeys = keys(stateValue);\n    var subStateNodes = subStateKeys.map(function (subStateKey) {\n      return _this.getStateNode(subStateKey);\n    });\n    return subStateNodes.concat(subStateKeys.reduce(function (allSubStateNodes, subStateKey) {\n      var subStateNode = _this.getStateNode(subStateKey).getStateNodes(stateValue[subStateKey]);\n\n      return allSubStateNodes.concat(subStateNode);\n    }, []));\n  };\n  /**\r\n   * Returns `true` if this state node explicitly handles the given event.\r\n   *\r\n   * @param event The event in question\r\n   */\n\n\n  StateNode.prototype.handles = function (event) {\n    var eventType = getEventType(event);\n    return this.events.includes(eventType);\n  };\n  /**\r\n   * Resolves the given `state` to a new `State` instance relative to this machine.\r\n   *\r\n   * This ensures that `.events` and `.nextEvents` represent the correct values.\r\n   *\r\n   * @param state The state to resolve\r\n   */\n\n\n  StateNode.prototype.resolveState = function (state) {\n    var configuration = Array.from(getConfiguration([], this.getStateNodes(state.value)));\n    return new State(__assign(__assign({}, state), {\n      value: this.resolve(state.value),\n      configuration: configuration\n    }));\n  };\n\n  StateNode.prototype.transitionLeafNode = function (stateValue, state, _event) {\n    var stateNode = this.getStateNode(stateValue);\n    var next = stateNode.next(state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionCompoundNode = function (stateValue, state, _event) {\n    var subStateKeys = keys(stateValue);\n    var stateNode = this.getStateNode(subStateKeys[0]);\n\n    var next = stateNode._transition(stateValue[subStateKeys[0]], state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionParallelNode = function (stateValue, state, _event) {\n    var e_2, _a;\n\n    var transitionMap = {};\n\n    try {\n      for (var _b = __values(keys(stateValue)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var subStateKey = _c.value;\n        var subStateValue = stateValue[subStateKey];\n\n        if (!subStateValue) {\n          continue;\n        }\n\n        var subStateNode = this.getStateNode(subStateKey);\n\n        var next = subStateNode._transition(subStateValue, state, _event);\n\n        if (next) {\n          transitionMap[subStateKey] = next;\n        }\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    var stateTransitions = keys(transitionMap).map(function (key) {\n      return transitionMap[key];\n    });\n    var enabledTransitions = flatten(stateTransitions.map(function (st) {\n      return st.transitions;\n    }));\n    var willTransition = stateTransitions.some(function (st) {\n      return st.transitions.length > 0;\n    });\n\n    if (!willTransition) {\n      return this.next(state, _event);\n    }\n\n    var entryNodes = flatten(stateTransitions.map(function (t) {\n      return t.entrySet;\n    }));\n    var configuration = flatten(keys(transitionMap).map(function (key) {\n      return transitionMap[key].configuration;\n    }));\n    return {\n      transitions: enabledTransitions,\n      entrySet: entryNodes,\n      exitSet: flatten(stateTransitions.map(function (t) {\n        return t.exitSet;\n      })),\n      configuration: configuration,\n      source: state,\n      actions: flatten(keys(transitionMap).map(function (key) {\n        return transitionMap[key].actions;\n      }))\n    };\n  };\n\n  StateNode.prototype._transition = function (stateValue, state, _event) {\n    // leaf node\n    if (isString(stateValue)) {\n      return this.transitionLeafNode(stateValue, state, _event);\n    } // hierarchical node\n\n\n    if (keys(stateValue).length === 1) {\n      return this.transitionCompoundNode(stateValue, state, _event);\n    } // orthogonal node\n\n\n    return this.transitionParallelNode(stateValue, state, _event);\n  };\n\n  StateNode.prototype.next = function (state, _event) {\n    var e_3, _a;\n\n    var _this = this;\n\n    var eventName = _event.name;\n    var actions = [];\n    var nextStateNodes = [];\n    var selectedTransition;\n\n    try {\n      for (var _b = __values(this.getCandidates(eventName)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var candidate = _c.value;\n        var cond = candidate.cond,\n            stateIn = candidate.in;\n        var resolvedContext = state.context;\n        var isInState = stateIn ? isString(stateIn) && isStateId(stateIn) ? // Check if in state by ID\n        state.matches(toStateValue(this.getStateNodeById(stateIn).path, this.delimiter)) : // Check if in state by relative grandparent\n        matchesState(toStateValue(stateIn, this.delimiter), path(this.path.slice(0, -2))(state.value)) : true;\n        var guardPassed = false;\n\n        try {\n          guardPassed = !cond || this.evaluateGuard(cond, resolvedContext, _event, state);\n        } catch (err) {\n          throw new Error(\"Unable to evaluate guard '\" + (cond.name || cond.type) + \"' in transition for event '\" + eventName + \"' in state node '\" + this.id + \"':\\n\" + err.message);\n        }\n\n        if (guardPassed && isInState) {\n          if (candidate.target !== undefined) {\n            nextStateNodes = candidate.target;\n          }\n\n          actions.push.apply(actions, __spread(candidate.actions));\n          selectedTransition = candidate;\n          break;\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    if (!selectedTransition) {\n      return undefined;\n    }\n\n    if (!nextStateNodes.length) {\n      return {\n        transitions: [selectedTransition],\n        entrySet: [],\n        exitSet: [],\n        configuration: state.value ? [this] : [],\n        source: state,\n        actions: actions\n      };\n    }\n\n    var allNextStateNodes = flatten(nextStateNodes.map(function (stateNode) {\n      return _this.getRelativeStateNodes(stateNode, state.historyValue);\n    }));\n    var isInternal = !!selectedTransition.internal;\n    var reentryNodes = isInternal ? [] : flatten(allNextStateNodes.map(function (n) {\n      return _this.nodesFromChild(n);\n    }));\n    return {\n      transitions: [selectedTransition],\n      entrySet: reentryNodes,\n      exitSet: isInternal ? [] : [this],\n      configuration: allNextStateNodes,\n      source: state,\n      actions: actions\n    };\n  };\n\n  StateNode.prototype.nodesFromChild = function (childStateNode) {\n    if (childStateNode.escapes(this)) {\n      return [];\n    }\n\n    var nodes = [];\n    var marker = childStateNode;\n\n    while (marker && marker !== this) {\n      nodes.push(marker);\n      marker = marker.parent;\n    }\n\n    nodes.push(this); // inclusive\n\n    return nodes;\n  };\n  /**\r\n   * Whether the given state node \"escapes\" this state node. If the `stateNode` is equal to or the parent of\r\n   * this state node, it does not escape.\r\n   */\n\n\n  StateNode.prototype.escapes = function (stateNode) {\n    if (this === stateNode) {\n      return false;\n    }\n\n    var parent = this.parent;\n\n    while (parent) {\n      if (parent === stateNode) {\n        return false;\n      }\n\n      parent = parent.parent;\n    }\n\n    return true;\n  };\n\n  StateNode.prototype.evaluateGuard = function (guard, context, _event, state) {\n    var guards = this.machine.options.guards;\n    var guardMeta = {\n      state: state,\n      cond: guard,\n      _event: _event\n    }; // TODO: do not hardcode!\n\n    if (guard.type === DEFAULT_GUARD_TYPE) {\n      return guard.predicate(context, _event.data, guardMeta);\n    }\n\n    var condFn = guards[guard.type];\n\n    if (!condFn) {\n      throw new Error(\"Guard '\" + guard.type + \"' is not implemented on machine '\" + this.machine.id + \"'.\");\n    }\n\n    return condFn(context, _event.data, guardMeta);\n  };\n\n  StateNode.prototype.getActions = function (transition, currentContext, _event, prevState) {\n    var e_4, _a, e_5, _b;\n\n    var prevConfig = getConfiguration([], prevState ? this.getStateNodes(prevState.value) : [this]);\n    var resolvedConfig = transition.configuration.length ? getConfiguration(prevConfig, transition.configuration) : prevConfig;\n\n    try {\n      for (var resolvedConfig_1 = __values(resolvedConfig), resolvedConfig_1_1 = resolvedConfig_1.next(); !resolvedConfig_1_1.done; resolvedConfig_1_1 = resolvedConfig_1.next()) {\n        var sn = resolvedConfig_1_1.value;\n\n        if (!has(prevConfig, sn)) {\n          transition.entrySet.push(sn);\n        }\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (resolvedConfig_1_1 && !resolvedConfig_1_1.done && (_a = resolvedConfig_1.return)) _a.call(resolvedConfig_1);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    try {\n      for (var prevConfig_1 = __values(prevConfig), prevConfig_1_1 = prevConfig_1.next(); !prevConfig_1_1.done; prevConfig_1_1 = prevConfig_1.next()) {\n        var sn = prevConfig_1_1.value;\n\n        if (!has(resolvedConfig, sn) || has(transition.exitSet, sn.parent)) {\n          transition.exitSet.push(sn);\n        }\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (prevConfig_1_1 && !prevConfig_1_1.done && (_b = prevConfig_1.return)) _b.call(prevConfig_1);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    if (!transition.source) {\n      transition.exitSet = []; // Ensure that root StateNode (machine) is entered\n\n      transition.entrySet.push(this);\n    }\n\n    var doneEvents = flatten(transition.entrySet.map(function (sn) {\n      var events = [];\n\n      if (sn.type !== 'final') {\n        return events;\n      }\n\n      var parent = sn.parent;\n      events.push(done(sn.id, sn.data), // TODO: deprecate - final states should not emit done events for their own state.\n      done(parent.id, sn.data ? mapContext(sn.data, currentContext, _event) : undefined));\n\n      if (parent.parent) {\n        var grandparent = parent.parent;\n\n        if (grandparent.type === 'parallel') {\n          if (getChildren(grandparent).every(function (parentNode) {\n            return isInFinalState(transition.configuration, parentNode);\n          })) {\n            events.push(done(grandparent.id, grandparent.data));\n          }\n        }\n      }\n\n      return events;\n    }));\n    transition.exitSet.sort(function (a, b) {\n      return b.order - a.order;\n    });\n    transition.entrySet.sort(function (a, b) {\n      return a.order - b.order;\n    });\n    var entryStates = new Set(transition.entrySet);\n    var exitStates = new Set(transition.exitSet);\n\n    var _c = __read([flatten(Array.from(entryStates).map(function (stateNode) {\n      return __spread(stateNode.activities.map(function (activity) {\n        return start(activity);\n      }), stateNode.onEntry);\n    })).concat(doneEvents.map(raise)), flatten(Array.from(exitStates).map(function (stateNode) {\n      return __spread(stateNode.onExit, stateNode.activities.map(function (activity) {\n        return stop(activity);\n      }));\n    }))], 2),\n        entryActions = _c[0],\n        exitActions = _c[1];\n\n    var actions = toActionObjects(exitActions.concat(transition.actions).concat(entryActions), this.machine.options.actions);\n    return actions;\n  };\n  /**\r\n   * Determines the next state given the current `state` and sent `event`.\r\n   *\r\n   * @param state The current State instance or state value\r\n   * @param event The event that was sent at the current state\r\n   * @param context The current context (extended state) of the current state\r\n   */\n\n\n  StateNode.prototype.transition = function (state, event, context) {\n    if (state === void 0) {\n      state = this.initialState;\n    }\n\n    var _event = toSCXMLEvent(event);\n\n    var currentState;\n\n    if (state instanceof State) {\n      currentState = context === undefined ? state : this.resolveState(State.from(state, context));\n    } else {\n      var resolvedStateValue = isString(state) ? this.resolve(pathToStateValue(this.getResolvedPath(state))) : this.resolve(state);\n      var resolvedContext = context ? context : this.machine.context;\n      currentState = this.resolveState(State.from(resolvedStateValue, resolvedContext));\n    }\n\n    if (!IS_PRODUCTION && _event.name === WILDCARD) {\n      throw new Error(\"An event cannot have the wildcard type ('\" + WILDCARD + \"')\");\n    }\n\n    if (this.strict) {\n      if (!this.events.includes(_event.name) && !isBuiltInEvent(_event.name)) {\n        throw new Error(\"Machine '\" + this.id + \"' does not accept event '\" + _event.name + \"'\");\n      }\n    }\n\n    var stateTransition = this._transition(currentState.value, currentState, _event) || {\n      transitions: [],\n      configuration: [],\n      entrySet: [],\n      exitSet: [],\n      source: currentState,\n      actions: []\n    };\n    var prevConfig = getConfiguration([], this.getStateNodes(currentState.value));\n    var resolvedConfig = stateTransition.configuration.length ? getConfiguration(prevConfig, stateTransition.configuration) : prevConfig;\n    stateTransition.configuration = __spread(resolvedConfig);\n    return this.resolveTransition(stateTransition, currentState, _event);\n  };\n\n  StateNode.prototype.resolveRaisedTransition = function (state, _event, originalEvent) {\n    var _a;\n\n    var currentActions = state.actions;\n    state = this.transition(state, _event); // Save original event to state\n\n    state._event = originalEvent;\n    state.event = originalEvent.data;\n\n    (_a = state.actions).unshift.apply(_a, __spread(currentActions));\n\n    return state;\n  };\n\n  StateNode.prototype.resolveTransition = function (stateTransition, currentState, _event, context) {\n    var e_6, _a;\n\n    var _this = this;\n\n    if (_event === void 0) {\n      _event = initEvent;\n    }\n\n    if (context === void 0) {\n      context = this.machine.context;\n    }\n\n    var configuration = stateTransition.configuration; // Transition will \"apply\" if:\n    // - this is the initial state (there is no current state)\n    // - OR there are transitions\n\n    var willTransition = !currentState || stateTransition.transitions.length > 0;\n    var resolvedStateValue = willTransition ? getValue(this.machine, configuration) : undefined;\n    var historyValue = currentState ? currentState.historyValue ? currentState.historyValue : stateTransition.source ? this.machine.historyValue(currentState.value) : undefined : undefined;\n    var currentContext = currentState ? currentState.context : context;\n    var actions = this.getActions(stateTransition, currentContext, _event, currentState);\n    var activities = currentState ? __assign({}, currentState.activities) : {};\n\n    try {\n      for (var actions_1 = __values(actions), actions_1_1 = actions_1.next(); !actions_1_1.done; actions_1_1 = actions_1.next()) {\n        var action = actions_1_1.value;\n\n        if (action.type === start$1) {\n          activities[action.activity.type] = action;\n        } else if (action.type === stop$1) {\n          activities[action.activity.type] = false;\n        }\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (actions_1_1 && !actions_1_1.done && (_a = actions_1.return)) _a.call(actions_1);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    var _b = __read(partition(actions, function (action) {\n      return action.type === assign;\n    }), 2),\n        assignActions = _b[0],\n        otherActions = _b[1];\n\n    var updatedContext = assignActions.length ? updateContext(currentContext, _event, assignActions, currentState) : currentContext;\n    var resolvedActions = flatten(otherActions.map(function (actionObject) {\n      switch (actionObject.type) {\n        case raise$1:\n          return resolveRaise(actionObject);\n\n        case send:\n          var sendAction = resolveSend(actionObject, updatedContext, _event, _this.machine.options.delays); // TODO: fix ActionTypes.Init\n\n          if (!IS_PRODUCTION) {\n            // warn after resolving as we can create better contextual message here\n            warn(!isString(actionObject.delay) || typeof sendAction.delay === 'number', // tslint:disable-next-line:max-line-length\n            \"No delay reference for delay expression '\" + actionObject.delay + \"' was found on machine '\" + _this.machine.id + \"'\");\n          }\n\n          return sendAction;\n\n        case log:\n          return resolveLog(actionObject, updatedContext, _event);\n\n        case pure:\n          return actionObject.get(updatedContext, _event.data) || [];\n\n        default:\n          return toActionObject(actionObject, _this.options.actions);\n      }\n    }));\n\n    var _c = __read(partition(resolvedActions, function (action) {\n      return action.type === raise$1 || action.type === send && action.to === SpecialTargets.Internal;\n    }), 2),\n        raisedEvents = _c[0],\n        nonRaisedActions = _c[1];\n\n    var invokeActions = resolvedActions.filter(function (action) {\n      return action.type === start$1 && action.activity.type === invoke;\n    });\n    var children = invokeActions.reduce(function (acc, action) {\n      acc[action.activity.id] = createInvocableActor(action.activity);\n      return acc;\n    }, currentState ? __assign({}, currentState.children) : {});\n    var resolvedConfiguration = resolvedStateValue ? stateTransition.configuration : currentState ? currentState.configuration : [];\n    var meta = resolvedConfiguration.reduce(function (acc, stateNode) {\n      if (stateNode.meta !== undefined) {\n        acc[stateNode.id] = stateNode.meta;\n      }\n\n      return acc;\n    }, {});\n    var isDone = isInFinalState(resolvedConfiguration, this);\n    var nextState = new State({\n      value: resolvedStateValue || currentState.value,\n      context: updatedContext,\n      _event: _event,\n      // Persist _sessionid between states\n      _sessionid: currentState ? currentState._sessionid : null,\n      historyValue: resolvedStateValue ? historyValue ? updateHistoryValue(historyValue, resolvedStateValue) : undefined : currentState ? currentState.historyValue : undefined,\n      history: !resolvedStateValue || stateTransition.source ? currentState : undefined,\n      actions: resolvedStateValue ? nonRaisedActions : [],\n      activities: resolvedStateValue ? activities : currentState ? currentState.activities : {},\n      meta: resolvedStateValue ? meta : currentState ? currentState.meta : undefined,\n      events: [],\n      configuration: resolvedConfiguration,\n      transitions: stateTransition.transitions,\n      children: children,\n      done: isDone\n    });\n    nextState.changed = _event.name === update || !!assignActions.length; // Dispose of penultimate histories to prevent memory leaks\n\n    var history = nextState.history;\n\n    if (history) {\n      delete history.history;\n    }\n\n    if (!resolvedStateValue) {\n      return nextState;\n    }\n\n    var maybeNextState = nextState;\n\n    if (!isDone) {\n      var isTransient = this._transient || configuration.some(function (stateNode) {\n        return stateNode._transient;\n      });\n\n      if (isTransient) {\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, {\n          type: nullEvent\n        }, _event);\n      }\n\n      while (raisedEvents.length) {\n        var raisedEvent = raisedEvents.shift();\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, raisedEvent._event, _event);\n      }\n    } // Detect if state changed\n\n\n    var changed = maybeNextState.changed || (history ? !!maybeNextState.actions.length || !!assignActions.length || typeof history.value !== typeof maybeNextState.value || !stateValuesEqual(maybeNextState.value, history.value) : undefined);\n    maybeNextState.changed = changed; // Preserve original history after raised events\n\n    maybeNextState.historyValue = nextState.historyValue;\n    maybeNextState.history = history;\n    return maybeNextState;\n  };\n  /**\r\n   * Returns the child state node from its relative `stateKey`, or throws.\r\n   */\n\n\n  StateNode.prototype.getStateNode = function (stateKey) {\n    if (isStateId(stateKey)) {\n      return this.machine.getStateNodeById(stateKey);\n    }\n\n    if (!this.states) {\n      throw new Error(\"Unable to retrieve child state '\" + stateKey + \"' from '\" + this.id + \"'; no child states exist.\");\n    }\n\n    var result = this.states[stateKey];\n\n    if (!result) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return result;\n  };\n  /**\r\n   * Returns the state node with the given `stateId`, or throws.\r\n   *\r\n   * @param stateId The state ID. The prefix \"#\" is removed.\r\n   */\n\n\n  StateNode.prototype.getStateNodeById = function (stateId) {\n    var resolvedStateId = isStateId(stateId) ? stateId.slice(STATE_IDENTIFIER.length) : stateId;\n\n    if (resolvedStateId === this.id) {\n      return this;\n    }\n\n    var stateNode = this.machine.idMap[resolvedStateId];\n\n    if (!stateNode) {\n      throw new Error(\"Child state node '#\" + resolvedStateId + \"' does not exist on machine '\" + this.id + \"'\");\n    }\n\n    return stateNode;\n  };\n  /**\r\n   * Returns the relative state node from the given `statePath`, or throws.\r\n   *\r\n   * @param statePath The string or string array relative path to the state node.\r\n   */\n\n\n  StateNode.prototype.getStateNodeByPath = function (statePath) {\n    if (typeof statePath === 'string' && isStateId(statePath)) {\n      try {\n        return this.getStateNodeById(statePath.slice(1));\n      } catch (e) {// try individual paths\n        // throw e;\n      }\n    }\n\n    var arrayStatePath = toStatePath(statePath, this.delimiter).slice();\n    var currentStateNode = this;\n\n    while (arrayStatePath.length) {\n      var key = arrayStatePath.shift();\n\n      if (!key.length) {\n        break;\n      }\n\n      currentStateNode = currentStateNode.getStateNode(key);\n    }\n\n    return currentStateNode;\n  };\n  /**\r\n   * Resolves a partial state value with its full representation in this machine.\r\n   *\r\n   * @param stateValue The partial state value to resolve.\r\n   */\n\n\n  StateNode.prototype.resolve = function (stateValue) {\n    var _a;\n\n    var _this = this;\n\n    if (!stateValue) {\n      return this.initialStateValue || EMPTY_OBJECT; // TODO: type-specific properties\n    }\n\n    switch (this.type) {\n      case 'parallel':\n        return mapValues(this.initialStateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(stateValue[subStateKey] || subStateValue) : EMPTY_OBJECT;\n        });\n\n      case 'compound':\n        if (isString(stateValue)) {\n          var subStateNode = this.getStateNode(stateValue);\n\n          if (subStateNode.type === 'parallel' || subStateNode.type === 'compound') {\n            return _a = {}, _a[stateValue] = subStateNode.initialStateValue, _a;\n          }\n\n          return stateValue;\n        }\n\n        if (!keys(stateValue).length) {\n          return this.initialStateValue || {};\n        }\n\n        return mapValues(stateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(subStateValue) : EMPTY_OBJECT;\n        });\n\n      default:\n        return stateValue || EMPTY_OBJECT;\n    }\n  };\n\n  StateNode.prototype.getResolvedPath = function (stateIdentifier) {\n    if (isStateId(stateIdentifier)) {\n      var stateNode = this.machine.idMap[stateIdentifier.slice(STATE_IDENTIFIER.length)];\n\n      if (!stateNode) {\n        throw new Error(\"Unable to find state node '\" + stateIdentifier + \"'\");\n      }\n\n      return stateNode.path;\n    }\n\n    return toStatePath(stateIdentifier, this.delimiter);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateValue\", {\n    get: function () {\n      var _a;\n\n      if (this.__cache.initialStateValue) {\n        return this.__cache.initialStateValue;\n      }\n\n      var initialStateValue;\n\n      if (this.type === 'parallel') {\n        initialStateValue = mapFilterValues(this.states, function (state) {\n          return state.initialStateValue || EMPTY_OBJECT;\n        }, function (stateNode) {\n          return !(stateNode.type === 'history');\n        });\n      } else if (this.initial !== undefined) {\n        if (!this.states[this.initial]) {\n          throw new Error(\"Initial state '\" + this.initial + \"' not found on '\" + this.key + \"'\");\n        }\n\n        initialStateValue = isLeafNode(this.states[this.initial]) ? this.initial : (_a = {}, _a[this.initial] = this.states[this.initial].initialStateValue, _a);\n      }\n\n      this.__cache.initialStateValue = initialStateValue;\n      return this.__cache.initialStateValue;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.getInitialState = function (stateValue, context) {\n    var configuration = this.getStateNodes(stateValue);\n    return this.resolveTransition({\n      configuration: configuration,\n      entrySet: configuration,\n      exitSet: [],\n      transitions: [],\n      source: undefined,\n      actions: []\n    }, undefined, undefined, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialState\", {\n    /**\r\n     * The initial State instance, which includes all actions to be executed from\r\n     * entering the initial state.\r\n     */\n    get: function () {\n      this._init();\n\n      var initialStateValue = this.initialStateValue;\n\n      if (!initialStateValue) {\n        throw new Error(\"Cannot retrieve initial state from simple state '\" + this.id + \"'.\");\n      }\n\n      return this.getInitialState(initialStateValue);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"target\", {\n    /**\r\n     * The target state value of the history state node, if it exists. This represents the\r\n     * default state value to transition to if no history value exists yet.\r\n     */\n    get: function () {\n      var target;\n\n      if (this.type === 'history') {\n        var historyConfig = this.config;\n\n        if (isString(historyConfig.target)) {\n          target = isStateId(historyConfig.target) ? pathToStateValue(this.machine.getStateNodeById(historyConfig.target).path.slice(this.path.length - 1)) : historyConfig.target;\n        } else {\n          target = historyConfig.target;\n        }\n      }\n\n      return target;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Returns the leaf nodes from a state path relative to this state node.\r\n   *\r\n   * @param relativeStateId The relative state path to retrieve the state nodes\r\n   * @param history The previous state to retrieve history\r\n   * @param resolve Whether state nodes should resolve to initial child state nodes\r\n   */\n\n  StateNode.prototype.getRelativeStateNodes = function (relativeStateId, historyValue, resolve) {\n    if (resolve === void 0) {\n      resolve = true;\n    }\n\n    return resolve ? relativeStateId.type === 'history' ? relativeStateId.resolveHistory(historyValue) : relativeStateId.initialStateNodes : [relativeStateId];\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateNodes\", {\n    get: function () {\n      var _this = this;\n\n      if (isLeafNode(this)) {\n        return [this];\n      } // Case when state node is compound but no initial state is defined\n\n\n      if (this.type === 'compound' && !this.initial) {\n        if (!IS_PRODUCTION) {\n          warn(false, \"Compound state node '\" + this.id + \"' has no initial state.\");\n        }\n\n        return [this];\n      }\n\n      var initialStateNodePaths = toStatePaths(this.initialStateValue);\n      return flatten(initialStateNodePaths.map(function (initialPath) {\n        return _this.getFromRelativePath(initialPath);\n      }));\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Retrieves state nodes from a relative path to this state node.\r\n   *\r\n   * @param relativePath The relative path from this state node\r\n   * @param historyValue\r\n   */\n\n  StateNode.prototype.getFromRelativePath = function (relativePath) {\n    if (!relativePath.length) {\n      return [this];\n    }\n\n    var _a = __read(relativePath),\n        stateKey = _a[0],\n        childStatePath = _a.slice(1);\n\n    if (!this.states) {\n      throw new Error(\"Cannot retrieve subPath '\" + stateKey + \"' from node with no states\");\n    }\n\n    var childStateNode = this.getStateNode(stateKey);\n\n    if (childStateNode.type === 'history') {\n      return childStateNode.resolveHistory();\n    }\n\n    if (!this.states[stateKey]) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return this.states[stateKey].getFromRelativePath(childStatePath);\n  };\n\n  StateNode.prototype.historyValue = function (relativeStateValue) {\n    if (!keys(this.states).length) {\n      return undefined;\n    }\n\n    return {\n      current: relativeStateValue || this.initialStateValue,\n      states: mapFilterValues(this.states, function (stateNode, key) {\n        if (!relativeStateValue) {\n          return stateNode.historyValue();\n        }\n\n        var subStateValue = isString(relativeStateValue) ? undefined : relativeStateValue[key];\n        return stateNode.historyValue(subStateValue || stateNode.initialStateValue);\n      }, function (stateNode) {\n        return !stateNode.history;\n      })\n    };\n  };\n  /**\r\n   * Resolves to the historical value(s) of the parent state node,\r\n   * represented by state nodes.\r\n   *\r\n   * @param historyValue\r\n   */\n\n\n  StateNode.prototype.resolveHistory = function (historyValue) {\n    var _this = this;\n\n    if (this.type !== 'history') {\n      return [this];\n    }\n\n    var parent = this.parent;\n\n    if (!historyValue) {\n      var historyTarget = this.target;\n      return historyTarget ? flatten(toStatePaths(historyTarget).map(function (relativeChildPath) {\n        return parent.getFromRelativePath(relativeChildPath);\n      })) : parent.initialStateNodes;\n    }\n\n    var subHistoryValue = nestedPath(parent.path, 'states')(historyValue).current;\n\n    if (isString(subHistoryValue)) {\n      return [parent.getStateNode(subHistoryValue)];\n    }\n\n    return flatten(toStatePaths(subHistoryValue).map(function (subStatePath) {\n      return _this.history === 'deep' ? parent.getFromRelativePath(subStatePath) : [parent.states[subStatePath[0]]];\n    }));\n  };\n\n  Object.defineProperty(StateNode.prototype, \"stateIds\", {\n    /**\r\n     * All the state node IDs of this state node and its descendant state nodes.\r\n     */\n    get: function () {\n      var _this = this;\n\n      var childStateIds = flatten(keys(this.states).map(function (stateKey) {\n        return _this.states[stateKey].stateIds;\n      }));\n      return [this.id].concat(childStateIds);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"events\", {\n    /**\r\n     * All the event types accepted by this state node and its descendants.\r\n     */\n    get: function () {\n      var e_7, _a, e_8, _b;\n\n      if (this.__cache.events) {\n        return this.__cache.events;\n      }\n\n      var states = this.states;\n      var events = new Set(this.ownEvents);\n\n      if (states) {\n        try {\n          for (var _c = __values(keys(states)), _d = _c.next(); !_d.done; _d = _c.next()) {\n            var stateId = _d.value;\n            var state = states[stateId];\n\n            if (state.states) {\n              try {\n                for (var _e = (e_8 = void 0, __values(state.events)), _f = _e.next(); !_f.done; _f = _e.next()) {\n                  var event_1 = _f.value;\n                  events.add(\"\" + event_1);\n                }\n              } catch (e_8_1) {\n                e_8 = {\n                  error: e_8_1\n                };\n              } finally {\n                try {\n                  if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                } finally {\n                  if (e_8) throw e_8.error;\n                }\n              }\n            }\n          }\n        } catch (e_7_1) {\n          e_7 = {\n            error: e_7_1\n          };\n        } finally {\n          try {\n            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n          } finally {\n            if (e_7) throw e_7.error;\n          }\n        }\n      }\n\n      return this.__cache.events = Array.from(events);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"ownEvents\", {\n    /**\r\n     * All the events that have transitions directly from this state node.\r\n     *\r\n     * Excludes any inert events.\r\n     */\n    get: function () {\n      var events = new Set(this.transitions.filter(function (transition) {\n        return !(!transition.target && !transition.actions.length && transition.internal);\n      }).map(function (transition) {\n        return transition.eventType;\n      }));\n      return Array.from(events);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.resolveTarget = function (_target) {\n    var _this = this;\n\n    if (_target === undefined) {\n      // an undefined target signals that the state node should not transition from that state when receiving that event\n      return undefined;\n    }\n\n    return _target.map(function (target) {\n      if (!isString(target)) {\n        return target;\n      }\n\n      var isInternalTarget = target[0] === _this.delimiter; // If internal target is defined on machine,\n      // do not include machine key on target\n\n      if (isInternalTarget && !_this.parent) {\n        return _this.getStateNodeByPath(target.slice(1));\n      }\n\n      var resolvedTarget = isInternalTarget ? _this.key + target : target;\n\n      if (_this.parent) {\n        try {\n          var targetStateNode = _this.parent.getStateNodeByPath(resolvedTarget);\n\n          return targetStateNode;\n        } catch (err) {\n          throw new Error(\"Invalid transition definition for state node '\" + _this.id + \"':\\n\" + err.message);\n        }\n      } else {\n        return _this.getStateNodeByPath(resolvedTarget);\n      }\n    });\n  };\n\n  StateNode.prototype.formatTransition = function (transitionConfig) {\n    var _this = this;\n\n    var normalizedTarget = normalizeTarget(transitionConfig.target);\n    var internal = 'internal' in transitionConfig ? transitionConfig.internal : normalizedTarget ? normalizedTarget.some(function (_target) {\n      return isString(_target) && _target[0] === _this.delimiter;\n    }) : true;\n    var guards = this.machine.options.guards;\n    var target = this.resolveTarget(normalizedTarget);\n    return __assign(__assign({}, transitionConfig), {\n      actions: toActionObjects(toArray(transitionConfig.actions)),\n      cond: toGuard(transitionConfig.cond, guards),\n      target: target,\n      source: this,\n      internal: internal,\n      eventType: transitionConfig.event\n    });\n  };\n\n  StateNode.prototype.formatTransitions = function () {\n    var e_9, _a;\n\n    var _this = this;\n\n    var onConfig;\n\n    if (!this.config.on) {\n      onConfig = [];\n    } else if (Array.isArray(this.config.on)) {\n      onConfig = this.config.on;\n    } else {\n      var _b = this.config.on,\n          _c = WILDCARD,\n          _d = _b[_c],\n          wildcardConfigs = _d === void 0 ? [] : _d,\n          strictOnConfigs_1 = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n\n      onConfig = flatten(keys(strictOnConfigs_1).map(function (key) {\n        var arrayified = toTransitionConfigArray(key, strictOnConfigs_1[key]);\n\n        if (!IS_PRODUCTION) {\n          validateArrayifiedTransitions(_this, key, arrayified);\n        }\n\n        return arrayified;\n      }).concat(toTransitionConfigArray(WILDCARD, wildcardConfigs)));\n    }\n\n    var doneConfig = this.config.onDone ? toTransitionConfigArray(String(done(this.id)), this.config.onDone) : [];\n    var invokeConfig = flatten(this.invoke.map(function (invokeDef) {\n      var settleTransitions = [];\n\n      if (invokeDef.onDone) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(doneInvoke(invokeDef.id)), invokeDef.onDone)));\n      }\n\n      if (invokeDef.onError) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(error(invokeDef.id)), invokeDef.onError)));\n      }\n\n      return settleTransitions;\n    }));\n    var delayedTransitions = this.after;\n    var formattedTransitions = flatten(__spread(doneConfig, invokeConfig, onConfig).map(function (transitionConfig) {\n      return toArray(transitionConfig).map(function (transition) {\n        return _this.formatTransition(transition);\n      });\n    }));\n\n    try {\n      for (var delayedTransitions_1 = __values(delayedTransitions), delayedTransitions_1_1 = delayedTransitions_1.next(); !delayedTransitions_1_1.done; delayedTransitions_1_1 = delayedTransitions_1.next()) {\n        var delayedTransition = delayedTransitions_1_1.value;\n        formattedTransitions.push(delayedTransition);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (delayedTransitions_1_1 && !delayedTransitions_1_1.done && (_a = delayedTransitions_1.return)) _a.call(delayedTransitions_1);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    }\n\n    return formattedTransitions;\n  };\n\n  return StateNode;\n}();\n\nexport { StateNode };","import { StateNode } from './StateNode.js';\n\nfunction Machine(config, options, initialContext) {\n  if (initialContext === void 0) {\n    initialContext = config.context;\n  }\n\n  var resolvedInitialContext = typeof initialContext === 'function' ? initialContext() : initialContext;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nfunction createMachine(config, options) {\n  var resolvedInitialContext = typeof config.context === 'function' ? config.context() : config.context;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nexport { Machine, createMachine };","import { __assign } from './_virtual/_tslib.js';\nvar defaultOptions = {\n  deferEvents: false\n};\n\nvar Scheduler =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function Scheduler(options) {\n    this.processingEvent = false;\n    this.queue = [];\n    this.initialized = false;\n    this.options = __assign(__assign({}, defaultOptions), options);\n  }\n\n  Scheduler.prototype.initialize = function (callback) {\n    this.initialized = true;\n\n    if (callback) {\n      if (!this.options.deferEvents) {\n        this.schedule(callback);\n        return;\n      }\n\n      this.process(callback);\n    }\n\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.schedule = function (task) {\n    if (!this.initialized || this.processingEvent) {\n      this.queue.push(task);\n      return;\n    }\n\n    if (this.queue.length !== 0) {\n      throw new Error('Event queue should be empty when it is not processing events');\n    }\n\n    this.process(task);\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.clear = function () {\n    this.queue = [];\n  };\n\n  Scheduler.prototype.flushEvents = function () {\n    var nextCallback = this.queue.shift();\n\n    while (nextCallback) {\n      this.process(nextCallback);\n      nextCallback = this.queue.shift();\n    }\n  };\n\n  Scheduler.prototype.process = function (callback) {\n    this.processingEvent = true;\n\n    try {\n      callback();\n    } catch (e) {\n      // there is no use to keep the future events\n      // as the situation is not anymore the same\n      this.clear();\n      throw e;\n    } finally {\n      this.processingEvent = false;\n    }\n  };\n\n  return Scheduler;\n}();\n\nexport { Scheduler };","var children =\n/*#__PURE__*/\nnew Map();\nvar idMap =\n/*#__PURE__*/\nnew Map();\nvar sessionIdIndex = 0;\nvar registry = {\n  register: function (actor) {\n    var id = \"x:\" + sessionIdIndex++;\n    children.set(id, actor);\n    idMap.set(actor, id);\n    return id;\n  },\n  get: function (id) {\n    return children.get(id);\n  },\n  lookup: function (actorRef) {\n    return idMap.get(actorRef);\n  }\n};\nexport { registry };","import { __values, __assign, __spread } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { warn, mapContext, isFunction, keys, toSCXMLEvent, isPromiseLike, isObservable, isMachine, reportUnhandledExceptionOnInvocation, symbolObservable, isArray, toEventObject, isString, uniqueId } from './utils.js';\nimport { ActionTypes, SpecialTargets } from './types.js';\nimport { isInFinalState } from './stateUtils.js';\nimport { errorPlatform, log, stop, start, cancel, send, update, error as error$1 } from './actionTypes.js';\nimport { doneInvoke, initEvent, getActionFunction, error } from './actions.js';\nimport { isState, State, bindActionToState } from './State.js';\nimport { isActor } from './Actor.js';\nimport { Scheduler } from './scheduler.js';\nimport { registry } from './registry.js';\nimport { registerService } from './devTools.js';\nvar DEFAULT_SPAWN_OPTIONS = {\n  sync: false,\n  autoForward: false\n};\n/**\r\n * Maintains a stack of the current service in scope.\r\n * This is used to provide the correct service to spawn().\r\n *\r\n * @private\r\n */\n\nvar withServiceScope =\n/*#__PURE__*/\nfunction () {\n  var serviceStack = [];\n  return function (service, fn) {\n    service && serviceStack.push(service);\n    var result = fn(service || serviceStack[serviceStack.length - 1]);\n    service && serviceStack.pop();\n    return result;\n  };\n}();\n\nvar InterpreterStatus;\n\n(function (InterpreterStatus) {\n  InterpreterStatus[InterpreterStatus[\"NotStarted\"] = 0] = \"NotStarted\";\n  InterpreterStatus[InterpreterStatus[\"Running\"] = 1] = \"Running\";\n  InterpreterStatus[InterpreterStatus[\"Stopped\"] = 2] = \"Stopped\";\n})(InterpreterStatus || (InterpreterStatus = {}));\n\nvar Interpreter =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new Interpreter instance (i.e., service) for the given machine with the provided options, if any.\r\n   *\r\n   * @param machine The machine to be interpreted\r\n   * @param options Interpreter options\r\n   */\n  function Interpreter(machine, options, sessionId) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = Interpreter.defaultOptions;\n    }\n\n    this.machine = machine;\n    this.scheduler = new Scheduler();\n    this.delayedEventsMap = {};\n    this.listeners = new Set();\n    this.contextListeners = new Set();\n    this.stopListeners = new Set();\n    this.doneListeners = new Set();\n    this.eventListeners = new Set();\n    this.sendListeners = new Set();\n    /**\r\n     * Whether the service is started.\r\n     */\n\n    this.initialized = false;\n    this._status = InterpreterStatus.NotStarted;\n    this.children = new Map();\n    this.forwardTo = new Set();\n    /**\r\n     * Alias for Interpreter.prototype.start\r\n     */\n\n    this.init = this.start;\n    /**\r\n     * Sends an event to the running interpreter to trigger a transition.\r\n     *\r\n     * An array of events (batched) can be sent as well, which will send all\r\n     * batched events to the running interpreter. The listeners will be\r\n     * notified only **once** when all events are processed.\r\n     *\r\n     * @param event The event(s) to send\r\n     */\n\n    this.send = function (event, payload) {\n      if (isArray(event)) {\n        _this.batch(event);\n\n        return _this.state;\n      }\n\n      var _event = toSCXMLEvent(toEventObject(event, payload));\n\n      if (_this._status === InterpreterStatus.Stopped) {\n        // do nothing\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to stopped service \\\"\" + _this.machine.id + \"\\\". This service has already reached its final state, and will not transition.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n\n        return _this.state;\n      }\n\n      if (_this._status === InterpreterStatus.NotStarted && _this.options.deferEvents) {\n        // tslint:disable-next-line:no-console\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\" and is deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n      } else if (_this._status !== InterpreterStatus.Running) {\n        throw new Error(\"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\\nEvent: \" + JSON.stringify(_event.data));\n      }\n\n      _this.scheduler.schedule(function () {\n        // Forward copy of event to child actors\n        _this.forward(_event);\n\n        var nextState = _this.nextState(_event);\n\n        _this.update(nextState, _event);\n      });\n\n      return _this._state; // TODO: deprecate (should return void)\n      // tslint:disable-next-line:semicolon\n    };\n\n    this.sendTo = function (event, to) {\n      var isParent = _this.parent && (to === SpecialTargets.Parent || _this.parent.id === to);\n      var target = isParent ? _this.parent : isActor(to) ? to : _this.children.get(to) || registry.get(to);\n\n      if (!target) {\n        if (!isParent) {\n          throw new Error(\"Unable to send event to child '\" + to + \"' from service '\" + _this.id + \"'.\");\n        } // tslint:disable-next-line:no-console\n\n\n        if (!IS_PRODUCTION) {\n          warn(false, \"Service '\" + _this.id + \"' has no parent: unable to send event \" + event.type);\n        }\n\n        return;\n      }\n\n      if ('machine' in target) {\n        // Send SCXML events to machines\n        target.send(__assign(__assign({}, event), {\n          name: event.name === error$1 ? \"\" + error(_this.id) : event.name,\n          origin: _this.sessionId\n        }));\n      } else {\n        // Send normal events to other targets\n        target.send(event.data);\n      }\n    };\n\n    var resolvedOptions = __assign(__assign({}, Interpreter.defaultOptions), options);\n\n    var clock = resolvedOptions.clock,\n        logger = resolvedOptions.logger,\n        parent = resolvedOptions.parent,\n        id = resolvedOptions.id;\n    var resolvedId = id !== undefined ? id : machine.id;\n    this.id = resolvedId;\n    this.logger = logger;\n    this.clock = clock;\n    this.parent = parent;\n    this.options = resolvedOptions;\n    this.scheduler = new Scheduler({\n      deferEvents: this.options.deferEvents\n    });\n    this.sessionId = sessionId !== undefined ? sessionId : registry.register(this);\n  }\n\n  Object.defineProperty(Interpreter.prototype, \"initialState\", {\n    get: function () {\n      var _this = this;\n\n      if (this._initialState) {\n        return this._initialState;\n      }\n\n      return withServiceScope(this, function () {\n        _this._initialState = _this.machine.initialState;\n        return _this._initialState;\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Interpreter.prototype, \"state\", {\n    get: function () {\n      if (!IS_PRODUCTION) {\n        warn(this._status !== InterpreterStatus.NotStarted, \"Attempted to read state from uninitialized service '\" + this.id + \"'. Make sure the service is started first.\");\n      }\n\n      return this._state;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Executes the actions of the given state, with that state's `context` and `event`.\r\n   *\r\n   * @param state The state whose actions will be executed\r\n   * @param actionsConfig The action implementations to use\r\n   */\n\n  Interpreter.prototype.execute = function (state, actionsConfig) {\n    var e_1, _a;\n\n    try {\n      for (var _b = __values(state.actions), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var action = _c.value;\n        this.exec(action, state, actionsConfig);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.update = function (state, _event) {\n    var e_2, _a, e_3, _b, e_4, _c, e_5, _d;\n\n    var _this = this; // Attach session ID to state\n\n\n    state._sessionid = this.sessionId; // Update state\n\n    this._state = state; // Execute actions\n\n    if (this.options.execute) {\n      this.execute(this.state);\n    } // Dev tools\n\n\n    if (this.devTools) {\n      this.devTools.send(_event.data, state);\n    } // Execute listeners\n\n\n    if (state.event) {\n      try {\n        for (var _e = __values(this.eventListeners), _f = _e.next(); !_f.done; _f = _e.next()) {\n          var listener = _f.value;\n          listener(state.event);\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_f && !_f.done && (_a = _e.return)) _a.call(_e);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n    }\n\n    try {\n      for (var _g = __values(this.listeners), _h = _g.next(); !_h.done; _h = _g.next()) {\n        var listener = _h.value;\n        listener(state, state.event);\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_h && !_h.done && (_b = _g.return)) _b.call(_g);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    try {\n      for (var _j = __values(this.contextListeners), _k = _j.next(); !_k.done; _k = _j.next()) {\n        var contextListener = _k.value;\n        contextListener(this.state.context, this.state.history ? this.state.history.context : undefined);\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_k && !_k.done && (_c = _j.return)) _c.call(_j);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    var isDone = isInFinalState(state.configuration || [], this.machine);\n\n    if (this.state.configuration && isDone) {\n      // get final child state node\n      var finalChildStateNode = state.configuration.find(function (sn) {\n        return sn.type === 'final' && sn.parent === _this.machine;\n      });\n      var doneData = finalChildStateNode && finalChildStateNode.data ? mapContext(finalChildStateNode.data, state.context, _event) : undefined;\n\n      try {\n        for (var _l = __values(this.doneListeners), _m = _l.next(); !_m.done; _m = _l.next()) {\n          var listener = _m.value;\n          listener(doneInvoke(this.id, doneData));\n        }\n      } catch (e_5_1) {\n        e_5 = {\n          error: e_5_1\n        };\n      } finally {\n        try {\n          if (_m && !_m.done && (_d = _l.return)) _d.call(_l);\n        } finally {\n          if (e_5) throw e_5.error;\n        }\n      }\n\n      this.stop();\n    }\n  };\n  /*\r\n   * Adds a listener that is notified whenever a state transition happens. The listener is called with\r\n   * the next state and the event object that caused the state transition.\r\n   *\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onTransition = function (listener) {\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state, this.state.event);\n    }\n\n    return this;\n  };\n\n  Interpreter.prototype.subscribe = function (nextListenerOrObserver, // @ts-ignore\n  errorListener, completeListener) {\n    var _this = this;\n\n    if (!nextListenerOrObserver) {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    }\n\n    var listener;\n    var resolvedCompleteListener = completeListener;\n\n    if (typeof nextListenerOrObserver === 'function') {\n      listener = nextListenerOrObserver;\n    } else {\n      listener = nextListenerOrObserver.next.bind(nextListenerOrObserver);\n      resolvedCompleteListener = nextListenerOrObserver.complete.bind(nextListenerOrObserver);\n    }\n\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state);\n    }\n\n    if (resolvedCompleteListener) {\n      this.onDone(resolvedCompleteListener);\n    }\n\n    return {\n      unsubscribe: function () {\n        listener && _this.listeners.delete(listener);\n        resolvedCompleteListener && _this.doneListeners.delete(resolvedCompleteListener);\n      }\n    };\n  };\n  /**\r\n   * Adds an event listener that is notified whenever an event is sent to the running interpreter.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onEvent = function (listener) {\n    this.eventListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds an event listener that is notified whenever a `send` event occurs.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onSend = function (listener) {\n    this.sendListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a context listener that is notified whenever the state context changes.\r\n   * @param listener The context listener\r\n   */\n\n\n  Interpreter.prototype.onChange = function (listener) {\n    this.contextListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a listener that is notified when the machine is stopped.\r\n   * @param listener The listener\r\n   */\n\n\n  Interpreter.prototype.onStop = function (listener) {\n    this.stopListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a state listener that is notified when the statechart has reached its final state.\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onDone = function (listener) {\n    this.doneListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Removes a listener.\r\n   * @param listener The listener to remove\r\n   */\n\n\n  Interpreter.prototype.off = function (listener) {\n    this.listeners.delete(listener);\n    this.eventListeners.delete(listener);\n    this.sendListeners.delete(listener);\n    this.stopListeners.delete(listener);\n    this.doneListeners.delete(listener);\n    this.contextListeners.delete(listener);\n    return this;\n  };\n  /**\r\n   * Starts the interpreter from the given state, or the initial state.\r\n   * @param initialState The state to start the statechart from\r\n   */\n\n\n  Interpreter.prototype.start = function (initialState) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.Running) {\n      // Do not restart the service if it is already started\n      return this;\n    }\n\n    this.initialized = true;\n    this._status = InterpreterStatus.Running;\n    var resolvedState = initialState === undefined ? this.initialState : withServiceScope(this, function () {\n      return isState(initialState) ? _this.machine.resolveState(initialState) : _this.machine.resolveState(State.from(initialState, _this.machine.context));\n    });\n\n    if (this.options.devTools) {\n      this.attachDev();\n    }\n\n    this.scheduler.initialize(function () {\n      _this.update(resolvedState, initEvent);\n    });\n    return this;\n  };\n  /**\r\n   * Stops the interpreter and unsubscribe all listeners.\r\n   *\r\n   * This will also notify the `onStop` listeners.\r\n   */\n\n\n  Interpreter.prototype.stop = function () {\n    var e_6, _a, e_7, _b, e_8, _c, e_9, _d, e_10, _e;\n\n    try {\n      for (var _f = __values(this.listeners), _g = _f.next(); !_g.done; _g = _f.next()) {\n        var listener = _g.value;\n        this.listeners.delete(listener);\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (_g && !_g.done && (_a = _f.return)) _a.call(_f);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    try {\n      for (var _h = __values(this.stopListeners), _j = _h.next(); !_j.done; _j = _h.next()) {\n        var listener = _j.value; // call listener, then remove\n\n        listener();\n        this.stopListeners.delete(listener);\n      }\n    } catch (e_7_1) {\n      e_7 = {\n        error: e_7_1\n      };\n    } finally {\n      try {\n        if (_j && !_j.done && (_b = _h.return)) _b.call(_h);\n      } finally {\n        if (e_7) throw e_7.error;\n      }\n    }\n\n    try {\n      for (var _k = __values(this.contextListeners), _l = _k.next(); !_l.done; _l = _k.next()) {\n        var listener = _l.value;\n        this.contextListeners.delete(listener);\n      }\n    } catch (e_8_1) {\n      e_8 = {\n        error: e_8_1\n      };\n    } finally {\n      try {\n        if (_l && !_l.done && (_c = _k.return)) _c.call(_k);\n      } finally {\n        if (e_8) throw e_8.error;\n      }\n    }\n\n    try {\n      for (var _m = __values(this.doneListeners), _o = _m.next(); !_o.done; _o = _m.next()) {\n        var listener = _o.value;\n        this.doneListeners.delete(listener);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (_o && !_o.done && (_d = _m.return)) _d.call(_m);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    } // Stop all children\n\n\n    this.children.forEach(function (child) {\n      if (isFunction(child.stop)) {\n        child.stop();\n      }\n    });\n\n    try {\n      // Cancel all delayed events\n      for (var _p = __values(keys(this.delayedEventsMap)), _q = _p.next(); !_q.done; _q = _p.next()) {\n        var key = _q.value;\n        this.clock.clearTimeout(this.delayedEventsMap[key]);\n      }\n    } catch (e_10_1) {\n      e_10 = {\n        error: e_10_1\n      };\n    } finally {\n      try {\n        if (_q && !_q.done && (_e = _p.return)) _e.call(_p);\n      } finally {\n        if (e_10) throw e_10.error;\n      }\n    }\n\n    this.scheduler.clear();\n    this.initialized = false;\n    this._status = InterpreterStatus.Stopped;\n    return this;\n  };\n\n  Interpreter.prototype.batch = function (events) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.NotStarted && this.options.deferEvents) {\n      // tslint:disable-next-line:no-console\n      if (!IS_PRODUCTION) {\n        warn(false, events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\" and are deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(event));\n      }\n    } else if (this._status !== InterpreterStatus.Running) {\n      throw new Error( // tslint:disable-next-line:max-line-length\n      events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\");\n    }\n\n    this.scheduler.schedule(function () {\n      var e_11, _a;\n\n      var nextState = _this.state;\n      var batchChanged = false;\n      var batchedActions = [];\n\n      var _loop_1 = function (event_1) {\n        var _event = toSCXMLEvent(event_1);\n\n        _this.forward(_event);\n\n        nextState = withServiceScope(_this, function () {\n          return _this.machine.transition(nextState, _event);\n        });\n        batchedActions.push.apply(batchedActions, __spread(nextState.actions.map(function (a) {\n          return bindActionToState(a, nextState);\n        })));\n        batchChanged = batchChanged || !!nextState.changed;\n      };\n\n      try {\n        for (var events_1 = __values(events), events_1_1 = events_1.next(); !events_1_1.done; events_1_1 = events_1.next()) {\n          var event_1 = events_1_1.value;\n\n          _loop_1(event_1);\n        }\n      } catch (e_11_1) {\n        e_11 = {\n          error: e_11_1\n        };\n      } finally {\n        try {\n          if (events_1_1 && !events_1_1.done && (_a = events_1.return)) _a.call(events_1);\n        } finally {\n          if (e_11) throw e_11.error;\n        }\n      }\n\n      nextState.changed = batchChanged;\n      nextState.actions = batchedActions;\n\n      _this.update(nextState, toSCXMLEvent(events[events.length - 1]));\n    });\n  };\n  /**\r\n   * Returns a send function bound to this interpreter instance.\r\n   *\r\n   * @param event The event to be sent by the sender.\r\n   */\n\n\n  Interpreter.prototype.sender = function (event) {\n    return this.send.bind(this, event);\n  };\n  /**\r\n   * Returns the next state given the interpreter's current state and the event.\r\n   *\r\n   * This is a pure method that does _not_ update the interpreter's state.\r\n   *\r\n   * @param event The event to determine the next state\r\n   */\n\n\n  Interpreter.prototype.nextState = function (event) {\n    var _this = this;\n\n    var _event = toSCXMLEvent(event);\n\n    if (_event.name.indexOf(errorPlatform) === 0 && !this.state.nextEvents.some(function (nextEvent) {\n      return nextEvent.indexOf(errorPlatform) === 0;\n    })) {\n      throw _event.data.data;\n    }\n\n    var nextState = withServiceScope(this, function () {\n      return _this.machine.transition(_this.state, _event);\n    });\n    return nextState;\n  };\n\n  Interpreter.prototype.forward = function (event) {\n    var e_12, _a;\n\n    try {\n      for (var _b = __values(this.forwardTo), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var id = _c.value;\n        var child = this.children.get(id);\n\n        if (!child) {\n          throw new Error(\"Unable to forward event '\" + event + \"' from interpreter '\" + this.id + \"' to nonexistant child '\" + id + \"'.\");\n        }\n\n        child.send(event);\n      }\n    } catch (e_12_1) {\n      e_12 = {\n        error: e_12_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_12) throw e_12.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.defer = function (sendAction) {\n    var _this = this;\n\n    this.delayedEventsMap[sendAction.id] = this.clock.setTimeout(function () {\n      if (sendAction.to) {\n        _this.sendTo(sendAction._event, sendAction.to);\n      } else {\n        _this.send(sendAction._event);\n      }\n    }, sendAction.delay);\n  };\n\n  Interpreter.prototype.cancel = function (sendId) {\n    this.clock.clearTimeout(this.delayedEventsMap[sendId]);\n    delete this.delayedEventsMap[sendId];\n  };\n\n  Interpreter.prototype.exec = function (action, state, actionFunctionMap) {\n    var context = state.context,\n        _event = state._event;\n    var actionOrExec = getActionFunction(action.type, actionFunctionMap) || action.exec;\n    var exec = isFunction(actionOrExec) ? actionOrExec : actionOrExec ? actionOrExec.exec : action.exec;\n\n    if (exec) {\n      try {\n        return exec(context, _event.data, {\n          action: action,\n          state: this.state,\n          _event: _event\n        });\n      } catch (err) {\n        if (this.parent) {\n          this.parent.send({\n            type: 'xstate.error',\n            data: err\n          });\n        }\n\n        throw err;\n      }\n    }\n\n    switch (action.type) {\n      case send:\n        var sendAction = action;\n\n        if (typeof sendAction.delay === 'number') {\n          this.defer(sendAction);\n          return;\n        } else {\n          if (sendAction.to) {\n            this.sendTo(sendAction._event, sendAction.to);\n          } else {\n            this.send(sendAction._event);\n          }\n        }\n\n        break;\n\n      case cancel:\n        this.cancel(action.sendId);\n        break;\n\n      case start:\n        {\n          var activity = action.activity; // If the activity will be stopped right after it's started\n          // (such as in transient states)\n          // don't bother starting the activity.\n\n          if (!this.state.activities[activity.type]) {\n            break;\n          } // Invoked services\n\n\n          if (activity.type === ActionTypes.Invoke) {\n            var serviceCreator = this.machine.options.services ? this.machine.options.services[activity.src] : undefined;\n            var id = activity.id,\n                data = activity.data;\n\n            if (!IS_PRODUCTION) {\n              warn(!('forward' in activity), // tslint:disable-next-line:max-line-length\n              \"`forward` property is deprecated (found in invocation of '\" + activity.src + \"' in in machine '\" + this.machine.id + \"'). \" + \"Please use `autoForward` instead.\");\n            }\n\n            var autoForward = 'autoForward' in activity ? activity.autoForward : !!activity.forward;\n\n            if (!serviceCreator) {\n              // tslint:disable-next-line:no-console\n              if (!IS_PRODUCTION) {\n                warn(false, \"No service found for invocation '\" + activity.src + \"' in machine '\" + this.machine.id + \"'.\");\n              }\n\n              return;\n            }\n\n            var source = isFunction(serviceCreator) ? serviceCreator(context, _event.data) : serviceCreator;\n\n            if (isPromiseLike(source)) {\n              this.state.children[id] = this.spawnPromise(Promise.resolve(source), id);\n            } else if (isFunction(source)) {\n              this.state.children[id] = this.spawnCallback(source, id);\n            } else if (isObservable(source)) {\n              this.state.children[id] = this.spawnObservable(source, id);\n            } else if (isMachine(source)) {\n              // TODO: try/catch here\n              this.state.children[id] = this.spawnMachine(data ? source.withContext(mapContext(data, context, _event)) : source, {\n                id: id,\n                autoForward: autoForward\n              });\n            }\n          } else {\n            this.spawnActivity(activity);\n          }\n\n          break;\n        }\n\n      case stop:\n        {\n          this.stopChild(action.activity.id);\n          break;\n        }\n\n      case log:\n        var label = action.label,\n            value = action.value;\n\n        if (label) {\n          this.logger(label, value);\n        } else {\n          this.logger(value);\n        }\n\n        break;\n\n      default:\n        if (!IS_PRODUCTION) {\n          warn(false, \"No implementation found for action type '\" + action.type + \"'\");\n        }\n\n        break;\n    }\n\n    return undefined;\n  };\n\n  Interpreter.prototype.stopChild = function (childId) {\n    var child = this.children.get(childId);\n\n    if (!child) {\n      return;\n    }\n\n    this.children.delete(childId);\n    this.forwardTo.delete(childId);\n    delete this.state.children[childId];\n\n    if (isFunction(child.stop)) {\n      child.stop();\n    }\n  };\n\n  Interpreter.prototype.spawn = function (entity, name, options) {\n    if (isPromiseLike(entity)) {\n      return this.spawnPromise(Promise.resolve(entity), name);\n    } else if (isFunction(entity)) {\n      return this.spawnCallback(entity, name);\n    } else if (isActor(entity)) {\n      return this.spawnActor(entity);\n    } else if (isObservable(entity)) {\n      return this.spawnObservable(entity, name);\n    } else if (isMachine(entity)) {\n      return this.spawnMachine(entity, __assign(__assign({}, options), {\n        id: name\n      }));\n    } else {\n      throw new Error(\"Unable to spawn entity \\\"\" + name + \"\\\" of type \\\"\" + typeof entity + \"\\\".\");\n    }\n  };\n\n  Interpreter.prototype.spawnMachine = function (machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var childService = new Interpreter(machine, __assign(__assign({}, this.options), {\n      parent: this,\n      id: options.id || machine.id\n    }));\n\n    var resolvedOptions = __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), options);\n\n    if (resolvedOptions.sync) {\n      childService.onTransition(function (state) {\n        _this.send(update, {\n          state: state,\n          id: childService.id\n        });\n      });\n    }\n\n    childService.onDone(function (doneEvent) {\n      _this.send(toSCXMLEvent(doneEvent, {\n        origin: childService.id\n      }));\n    }).start();\n    var actor = childService;\n    this.children.set(childService.id, actor);\n\n    if (resolvedOptions.autoForward) {\n      this.forwardTo.add(childService.id);\n    }\n\n    return actor;\n  };\n\n  Interpreter.prototype.spawnPromise = function (promise, id) {\n    var _this = this;\n\n    var canceled = false;\n    promise.then(function (response) {\n      if (!canceled) {\n        _this.send(toSCXMLEvent(doneInvoke(id, response), {\n          origin: id\n        }));\n      }\n    }, function (errorData) {\n      if (!canceled) {\n        var errorEvent = error(id, errorData);\n\n        try {\n          // Send \"error.platform.id\" to this (parent).\n          _this.send(toSCXMLEvent(errorEvent, {\n            origin: id\n          }));\n        } catch (error) {\n          reportUnhandledExceptionOnInvocation(errorData, error, id);\n\n          if (_this.devTools) {\n            _this.devTools.send(errorEvent, _this.state);\n          }\n\n          if (_this.machine.strict) {\n            // it would be better to always stop the state machine if unhandled\n            // exception/promise rejection happens but because we don't want to\n            // break existing code so enforce it on strict mode only especially so\n            // because documentation says that onError is optional\n            _this.stop();\n          }\n        }\n      }\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        var unsubscribed = false;\n        promise.then(function (response) {\n          if (unsubscribed) {\n            return;\n          }\n\n          next && next(response);\n\n          if (unsubscribed) {\n            return;\n          }\n\n          complete && complete();\n        }, function (err) {\n          if (unsubscribed) {\n            return;\n          }\n\n          handleError(err);\n        });\n        return {\n          unsubscribe: function () {\n            return unsubscribed = true;\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnCallback = function (callback, id) {\n    var _this = this;\n\n    var canceled = false;\n    var receivers = new Set();\n    var listeners = new Set();\n\n    var receive = function (e) {\n      listeners.forEach(function (listener) {\n        return listener(e);\n      });\n\n      if (canceled) {\n        return;\n      }\n\n      _this.send(e);\n    };\n\n    var callbackStop;\n\n    try {\n      callbackStop = callback(receive, function (newListener) {\n        receivers.add(newListener);\n      });\n    } catch (err) {\n      this.send(error(id, err));\n    }\n\n    if (isPromiseLike(callbackStop)) {\n      // it turned out to be an async function, can't reliably check this before calling `callback`\n      // because transpiled async functions are not recognizable\n      return this.spawnPromise(callbackStop, id);\n    }\n\n    var actor = {\n      id: id,\n      send: function (event) {\n        return receivers.forEach(function (receiver) {\n          return receiver(event);\n        });\n      },\n      subscribe: function (next) {\n        listeners.add(next);\n        return {\n          unsubscribe: function () {\n            listeners.delete(next);\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n\n        if (isFunction(callbackStop)) {\n          callbackStop();\n        }\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnObservable = function (source, id) {\n    var _this = this;\n\n    var subscription = source.subscribe(function (value) {\n      _this.send(toSCXMLEvent(value, {\n        origin: id\n      }));\n    }, function (err) {\n      _this.send(toSCXMLEvent(error(id, err), {\n        origin: id\n      }));\n    }, function () {\n      _this.send(toSCXMLEvent(doneInvoke(id), {\n        origin: id\n      }));\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        return source.subscribe(next, handleError, complete);\n      },\n      stop: function () {\n        return subscription.unsubscribe();\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActor = function (actor) {\n    this.children.set(actor.id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActivity = function (activity) {\n    var implementation = this.machine.options && this.machine.options.activities ? this.machine.options.activities[activity.type] : undefined;\n\n    if (!implementation) {\n      if (!IS_PRODUCTION) {\n        warn(false, \"No implementation found for activity '\" + activity.type + \"'\");\n      } // tslint:disable-next-line:no-console\n\n\n      return;\n    } // Start implementation\n\n\n    var dispose = implementation(this.state.context, activity);\n    this.spawnEffect(activity.id, dispose);\n  };\n\n  Interpreter.prototype.spawnEffect = function (id, dispose) {\n    this.children.set(id, {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function () {\n        return {\n          unsubscribe: function () {\n            return void 0;\n          }\n        };\n      },\n      stop: dispose || undefined,\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    });\n  };\n\n  Interpreter.prototype.attachDev = function () {\n    if (this.options.devTools && typeof window !== 'undefined') {\n      if (window.__REDUX_DEVTOOLS_EXTENSION__) {\n        var devToolsOptions = typeof this.options.devTools === 'object' ? this.options.devTools : undefined;\n        this.devTools = window.__REDUX_DEVTOOLS_EXTENSION__.connect(__assign(__assign({\n          name: this.id,\n          autoPause: true,\n          stateSanitizer: function (state) {\n            return {\n              value: state.value,\n              context: state.context,\n              actions: state.actions\n            };\n          }\n        }, devToolsOptions), {\n          features: __assign({\n            jump: false,\n            skip: false\n          }, devToolsOptions ? devToolsOptions.features : undefined)\n        }), this.machine);\n        this.devTools.init(this.state);\n      } // add XState-specific dev tooling hook\n\n\n      registerService(this);\n    }\n  };\n\n  Interpreter.prototype.toJSON = function () {\n    return {\n      id: this.id\n    };\n  };\n\n  Interpreter.prototype[symbolObservable] = function () {\n    return this;\n  };\n  /**\r\n   * The default interpreter options:\r\n   *\r\n   * - `clock` uses the global `setTimeout` and `clearTimeout` functions\r\n   * - `logger` uses the global `console.log()` method\r\n   */\n\n\n  Interpreter.defaultOptions =\n  /*#__PURE__*/\n  function (global) {\n    return {\n      execute: true,\n      deferEvents: true,\n      clock: {\n        setTimeout: function (fn, ms) {\n          return global.setTimeout.call(null, fn, ms);\n        },\n        clearTimeout: function (id) {\n          return global.clearTimeout.call(null, id);\n        }\n      },\n      logger: global.console.log.bind(console),\n      devTools: false\n    };\n  }(typeof window === 'undefined' ? global : window);\n\n  Interpreter.interpret = interpret;\n  return Interpreter;\n}();\n\nvar createNullActor = function (name) {\n  if (name === void 0) {\n    name = 'null';\n  }\n\n  return {\n    id: name,\n    send: function () {\n      return void 0;\n    },\n    subscribe: function () {\n      // tslint:disable-next-line:no-empty\n      return {\n        unsubscribe: function () {}\n      };\n    },\n    toJSON: function () {\n      return {\n        id: name\n      };\n    }\n  };\n};\n\nvar resolveSpawnOptions = function (nameOrOptions) {\n  if (isString(nameOrOptions)) {\n    return __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n      name: nameOrOptions\n    });\n  }\n\n  return __assign(__assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n    name: uniqueId()\n  }), nameOrOptions);\n};\n\nfunction spawn(entity, nameOrOptions) {\n  var resolvedOptions = resolveSpawnOptions(nameOrOptions);\n  return withServiceScope(undefined, function (service) {\n    if (!IS_PRODUCTION) {\n      warn(!!service, \"Attempted to spawn an Actor (ID: \\\"\" + (isMachine(entity) ? entity.id : 'undefined') + \"\\\") outside of a service. This will have no effect.\");\n    }\n\n    if (service) {\n      return service.spawn(entity, resolvedOptions.name, resolvedOptions);\n    } else {\n      return createNullActor(resolvedOptions.name);\n    }\n  });\n}\n/**\r\n * Creates a new Interpreter instance for the given machine with the provided options, if any.\r\n *\r\n * @param machine The machine to interpret\r\n * @param options Interpreter options\r\n */\n\n\nfunction interpret(machine, options) {\n  var interpreter = new Interpreter(machine, options);\n  return interpreter;\n}\n\nexport { Interpreter, interpret, spawn };","export { matchesState } from './utils.js';\nexport { mapState } from './mapState.js';\nexport { ActionTypes, SpecialTargets } from './types.js';\nimport { raise, send, sendParent, sendUpdate, log, cancel, start, stop, assign, after, done, respond, forwardTo, escalate } from './actions.js';\nexport { assign, doneInvoke, forwardTo, send, sendParent, sendUpdate } from './actions.js';\nexport { State } from './State.js';\nexport { StateNode } from './StateNode.js';\nexport { Machine, createMachine } from './Machine.js';\nexport { Interpreter, interpret, spawn } from './interpreter.js';\nexport { matchState } from './match.js';\nvar actions = {\n  raise: raise,\n  send: send,\n  sendParent: sendParent,\n  sendUpdate: sendUpdate,\n  log: log,\n  cancel: cancel,\n  start: start,\n  stop: stop,\n  assign: assign,\n  after: after,\n  done: done,\n  respond: respond,\n  forwardTo: forwardTo,\n  escalate: escalate\n};\nexport { actions };","import { __values } from './_virtual/_tslib.js';\nimport { keys, matchesState } from './utils.js';\n\nfunction mapState(stateMap, stateId) {\n  var e_1, _a;\n\n  var foundStateId;\n\n  try {\n    for (var _b = __values(keys(stateMap)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var mappedStateId = _c.value;\n\n      if (matchesState(mappedStateId, stateId) && (!foundStateId || stateId.length > foundStateId.length)) {\n        foundStateId = mappedStateId;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return stateMap[foundStateId];\n}\n\nexport { mapState };","import { __values, __read } from './_virtual/_tslib.js';\nimport { State } from './State.js';\n\nfunction matchState(state, patterns, defaultValue) {\n  var e_1, _a;\n\n  var resolvedState = State.from(state, state instanceof State ? state.context : undefined);\n\n  try {\n    for (var patterns_1 = __values(patterns), patterns_1_1 = patterns_1.next(); !patterns_1_1.done; patterns_1_1 = patterns_1.next()) {\n      var _b = __read(patterns_1_1.value, 2),\n          stateValue = _b[0],\n          getValue = _b[1];\n\n      if (resolvedState.matches(stateValue)) {\n        return getValue(resolvedState);\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (patterns_1_1 && !patterns_1_1.done && (_a = patterns_1.return)) _a.call(patterns_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return defaultValue(resolvedState);\n}\n\nexport { matchState };","\"use strict\";\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nfunction useActor(actor) {\n    var _a = __read(react_1.useState(undefined), 2), current = _a[0], setCurrent = _a[1];\n    var actorRef = react_1.useRef(actor);\n    react_1.useEffect(function () {\n        if (actor) {\n            actorRef.current = actor;\n            var sub_1 = actor.subscribe(setCurrent);\n            return function () {\n                sub_1.unsubscribe();\n            };\n        }\n    }, [actor]);\n    return [current, actorRef.current ? actorRef.current.send : function () { return void 0; }];\n}\nexports.useActor = useActor;\n//# sourceMappingURL=useActor.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nvar xstate_1 = require(\"xstate\");\nvar defaultOptions = {\n    immediate: false\n};\nfunction useMachine(machine, options) {\n    if (options === void 0) { options = defaultOptions; }\n    var context = options.context, guards = options.guards, actions = options.actions, activities = options.activities, services = options.services, delays = options.delays, immediate = options.immediate, rehydratedState = options.state, interpreterOptions = __rest(options, [\"context\", \"guards\", \"actions\", \"activities\", \"services\", \"delays\", \"immediate\", \"state\"]);\n    var machineConfig = {\n        context: context,\n        guards: guards,\n        actions: actions,\n        activities: activities,\n        services: services,\n        delays: delays\n    };\n    // Reference the machine\n    var machineRef = react_1.useRef(null);\n    // Create the machine only once\n    // See https://reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily\n    if (machineRef.current === null) {\n        machineRef.current = machine.withConfig(machineConfig, __assign(__assign({}, machine.context), context));\n    }\n    // Reference the service\n    var serviceRef = react_1.useRef(null);\n    // Create the service only once\n    if (serviceRef.current === null) {\n        serviceRef.current = xstate_1.interpret(machineRef.current, interpreterOptions).onTransition(function (state) {\n            // Update the current machine state when a transition occurs\n            if (state.changed) {\n                setCurrent(state);\n            }\n        });\n    }\n    var service = serviceRef.current;\n    // Make sure actions and services are kept updated when they change.\n    // This mutation assignment is safe because the service instance is only used\n    // in one place -- this hook's caller.\n    react_1.useEffect(function () {\n        Object.assign(service.machine.options.actions, actions);\n    }, [actions]);\n    react_1.useEffect(function () {\n        Object.assign(service.machine.options.services, services);\n    }, [services]);\n    // Keep track of the current machine state\n    var initialState = rehydratedState\n        ? xstate_1.State.create(rehydratedState)\n        : service.initialState;\n    var _a = __read(react_1.useState(function () { return initialState; }), 2), current = _a[0], setCurrent = _a[1];\n    // Start service immediately (before mount) if specified in options\n    if (immediate) {\n        service.start();\n    }\n    react_1.useEffect(function () {\n        // Start the service when the component mounts.\n        // Note: the service will start only if it hasn't started already.\n        //\n        // If a rehydrated state was provided, use the resolved `initialState`.\n        service.start(rehydratedState ? initialState : undefined);\n        return function () {\n            // Stop the service when the component unmounts\n            service.stop();\n        };\n    }, []);\n    return [current, service.send, service];\n}\nexports.useMachine = useMachine;\nfunction useService(service) {\n    var _a = __read(react_1.useState(service.state), 2), current = _a[0], setCurrent = _a[1];\n    react_1.useEffect(function () {\n        // Set to current service state as there is a possibility\n        // of a transition occurring between the initial useState()\n        // initialization and useEffect() commit.\n        setCurrent(service.state);\n        var listener = function (state) {\n            if (state.changed) {\n                setCurrent(state);\n            }\n        };\n        var sub = service.subscribe(listener);\n        return function () {\n            sub.unsubscribe();\n        };\n    }, [service]);\n    return [current, service.send, service];\n}\nexports.useService = useService;\nvar useActor_1 = require(\"./useActor\");\nexports.useActor = useActor_1.useActor;\n//# sourceMappingURL=index.js.map","import * as React from \"react\";\nimport { useMachine } from \"@xstate/react\";\nimport { Machine, StateSchema, assign } from \"xstate\";\n\ninterface IContext {\n  error: any[];\n  count: number;\n}\n\ninterface IStateSchema extends StateSchema<IContext> {\n  states: {\n    idle: {};\n    pending: {};\n  };\n}\n\ntype Event =\n  | { type: \"INIT\" }\n  | { type: \"RESOLVE\" }\n  | { type: \"REJECT\"; error: IContext[\"error\"][number] };\n\nconst ManagePromiseMachine = Machine<IContext, IStateSchema, Event>({\n  id: \"managePromise\",\n  initial: \"idle\",\n  context: {\n    error: [],\n    count: 0\n  },\n  states: {\n    idle: {\n      on: {\n        INIT: {\n          target: \"pending\",\n          actions: assign({\n            error: (_context, _event) => [],\n            count: (_context, _event) => 1\n          })\n        }\n      }\n    },\n    pending: {\n      on: {\n        \"\": {\n          cond: (context, _event) => context.count === 0,\n          target: \"idle\"\n        },\n        INIT: {\n          actions: assign({\n            count: (context, _event) => context.count + 1\n          })\n        },\n        RESOLVE: {\n          actions: assign({\n            count: (context, _event) => context.count - 1\n          })\n        },\n        REJECT: {\n          actions: assign({\n            error: (context, event) => context.error.concat(event.error),\n            count: (context, _event) => context.count - 1\n          })\n        }\n      }\n    }\n  }\n});\n\ntype PromiseState = Readonly<{\n  hasError: boolean;\n  isResolving: boolean;\n  error: IContext[\"error\"];\n}>;\n\ntype ManagePromiseFunction = <T>(promise: Promise<T>) => Promise<T>;\n\nexport const usePromiseManager = (): [PromiseState, ManagePromiseFunction] => {\n  const [current, send] = useMachine(ManagePromiseMachine);\n  const { error } = current.context;\n\n  const state = React.useMemo(\n    () => ({\n      hasError: error.length > 0,\n      isResolving: current.matches(\"pending\"),\n      error\n    }),\n    [error, current]\n  );\n\n  const manage: ManagePromiseFunction = React.useCallback(\n    async promise => {\n      send({ type: \"INIT\" });\n      return promise\n        .then(result => {\n          send({ type: \"RESOLVE\" });\n          return result;\n        })\n        .catch(error => {\n          send({ type: \"REJECT\", error });\n          return error;\n        });\n    },\n    [send]\n  );\n\n  return [state, manage];\n};\n"],"sourceRoot":""}